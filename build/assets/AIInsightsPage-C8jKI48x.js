import{c as D,r as l,j as e,S as I,B as c,C as o,e as x,ad as u}from"./index-CRIiYYAI.js";import{U as F,C as P}from"./utensils-9D_zl73m.js";import{C as A,T as R}from"./target-D9y72uOD.js";import{T as f}from"./trending-up-BAi8RDrt.js";import{T as O}from"./triangle-alert-CYnw1tlq.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_=D("settings",U);function z({onGetAIInsights:S}){const[a,h]=l.useState(null),[j,b]=l.useState(!1),[i,L]=l.useState(0),[m,M]=l.useState(0),[y,N]=l.useState("month");l.useEffect(()=>{const s=setInterval(()=>{if(i>0){const t=Date.now()-i,d=Math.max(0,Math.ceil((15e3-t)/1e3));M(d)}},1e3);return()=>clearInterval(s)},[i]);const v=async()=>{const s=Date.now();if(j||s-i<15e3){console.log("Skipping fetch - too soon since last call");return}b(!0),L(s);try{const t=await S();if(console.log("AI Insights fetched:",t),!t){console.warn("AI insights returned null/undefined"),h({insights:[],summary:"Unable to load AI insights at this time.",recommendations:[],patterns:[],predictions:null,stats:{thisMonth:0,lastMonth:0,change:0,changePercentage:0}});return}t.error&&console.warn("AI insights returned with error:",t.error),h(t)}catch(t){console.error("Failed to fetch insights:",t.message||t);let d="AI insights are temporarily unavailable.",p="Please try again in a few minutes.";t.message.includes("Rate limit")||t.message.includes("Too Many Requests")?(d="⏱️ AI rate limit reached",p="OpenRouter free tier: 3 AI calls per minute with 15s cooldown. Results are cached for 4 hours. Please wait before refreshing."):t.message.includes("cooldown")&&(d="⏱️ Cooldown active",p=t.message),h({insights:[{type:"info",severity:"warning",message:d,value:0}],summary:p,recommendations:[{priority:"low",action:"Cached AI insights are served to minimize API usage. The cache refreshes every 4 hours automatically.",potential_savings:0}],patterns:[],predictions:null,stats:{thisMonth:0,lastMonth:0,change:0,changePercentage:0}})}finally{b(!1)}};l.useEffect(()=>{v()},[]);const w=a?.stats?a.stats.thisMonth<a.stats.lastMonth?"under":"over":"under",r=a?.stats?.thisMonth??0,g=a?.stats?.lastMonth??0,k=a?.stats?.changePercentage??0,n=s=>`৳${Math.abs(s??0).toLocaleString("en-US",{maximumFractionDigits:0})}`,C=[{label:"Savings rate",value:g>0?`${Math.abs(r/g*100-100).toFixed(0)}%`:"0%",helper:"Dining & lifestyle",icon:F},{label:"Budget alarm",value:n(r*.05),helper:"Next 7 days risk",icon:A},{label:"Adherence delta",value:n(r*.15),helper:"Envelope buffers",icon:R},{label:"Unusual execution",value:`~${n(r*.1)}`,helper:"70% above baseline",icon:f}],T=[{label:"Month spend",value:n(r),hint:"Tracked via ledger"},{label:"Last refresh",value:i?new Date(i).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"Just now",hint:"Cached 4 hrs"},{label:"AI verdict",value:w==="under"?"Coasting":"Overshooting",hint:`${Math.abs(k).toFixed(0)}% vs last report`}];return j?e.jsx("div",{className:"max-w-7xl mx-auto space-y-10 pb-16",children:e.jsxs("section",{className:"rounded-[36px] border border-dashed border-emerald-200 bg-white p-12 text-center",children:[e.jsx("div",{className:"mx-auto flex h-20 w-20 items-center justify-center rounded-full bg-emerald-50",children:e.jsx(I,{className:"h-8 w-8 text-emerald-600 animate-spin"})}),e.jsx("p",{className:"mt-6 text-lg text-gray-600",children:"Analyzing your spending patterns..."}),e.jsx("p",{className:"text-sm text-gray-400",children:"AI copilots wake up in a few seconds."})]})}):a?e.jsxs("div",{className:"max-w-7xl mx-auto space-y-10 pb-16",children:[e.jsxs("section",{className:"relative overflow-hidden rounded-[36px] bg-gradient-to-br from-gray-900 via-emerald-950 to-gray-900 p-10 text-white",children:[e.jsx("div",{className:"absolute inset-0 opacity-40",style:{backgroundImage:"radial-gradient(circle at top, rgba(16,185,129,0.4), transparent 55%)"}}),e.jsxs("div",{className:"relative z-10 flex flex-col gap-10 lg:flex-row lg:items-end lg:justify-between",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.6em] text-emerald-200",children:"AI Copilot"}),e.jsx("h1",{className:"text-4xl lg:text-5xl font-semibold leading-tight",children:"Signal tower for every Taka you spend"}),e.jsx("p",{className:"text-white/70 max-w-2xl",children:"Tap into cached Gemini snapshots, see how envelopes behave, and jump straight into the next corrective ritual without wrestling spreadsheets."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1 rounded-full border border-white/20 bg-white/10 p-1",children:[e.jsx("button",{onClick:()=>N("month"),className:`rounded-full px-4 py-2 text-sm transition ${y==="month"?"bg-white text-gray-900":"text-white/70 hover:text-white"}`,children:"This month"}),e.jsx("button",{onClick:()=>N("quarter"),className:`rounded-full px-4 py-2 text-sm transition ${y==="quarter"?"bg-white text-gray-900":"text-white/70 hover:text-white"}`,children:"Last quarter"})]}),e.jsxs(c,{variant:"secondary",className:"rounded-full bg-white/15 text-white hover:bg-white/25",onClick:v,disabled:m>0,children:[e.jsx(_,{className:`mr-2 h-4 w-4 ${m>0?"animate-spin text-emerald-200":""}`}),"Refresh signal"]}),m>0&&e.jsxs("span",{className:"text-sm text-white/60",children:["Cooldown ",m,"s"]})]})]}),e.jsxs("div",{className:"w-full max-w-sm space-y-4 rounded-[28px] border border-white/15 bg-white/5 p-6 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-white/70",children:[e.jsx(I,{className:"h-5 w-5 text-emerald-300"}),"Live AI monitor"]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-3 lg:grid-cols-1",children:T.map(s=>e.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-white/60",children:s.label}),e.jsx("p",{className:"mt-3 text-2xl font-semibold",children:s.value}),e.jsx("p",{className:"text-xs text-white/60 mt-1",children:s.hint})]},s.label))})]})]})]}),e.jsxs("section",{className:"grid gap-6 lg:grid-cols-[1.2fr_0.8fr]",children:[e.jsx(o,{className:"rounded-[32px] border border-gray-200 shadow-sm",children:e.jsxs(x,{className:"space-y-6 p-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-500",children:"Budget posture"}),e.jsx("h2",{className:"text-3xl font-semibold text-gray-900",children:w==="under"?"Under budget":"Over budget"})]}),e.jsxs("div",{className:"rounded-full bg-emerald-50 px-4 py-1 text-sm text-emerald-700",children:[Math.abs(r-g).toFixed(0)," delta"]})]}),e.jsx("p",{className:"text-gray-600 text-sm leading-relaxed max-w-2xl",children:a.summary||"You consistently beating your goals. Keep it up!"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600",children:[e.jsx(f,{className:"h-5 w-5"}),e.jsxs("span",{className:"font-medium",children:[Math.abs(k).toFixed(0),"% since last report"]})]}),e.jsx(c,{className:"rounded-full bg-emerald-500 hover:bg-emerald-600 text-white",children:"Open ledger recap"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-3xl border border-blue-100 bg-blue-50/60 p-5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(u,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-900 font-medium",children:"Smart caching enabled"}),e.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Insights refresh every 4 hours. The manual refresh button enforces a 15s cooldown to stay under OpenRouter quotas."})]})]})}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:C.map(s=>{const t=s.icon;return e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:s.label}),e.jsx(t,{className:"h-4 w-4 text-gray-400"})]}),e.jsx("p",{className:"mt-3 text-2xl font-semibold text-gray-900",children:s.value}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s.helper})]},s.label)})})]})]}),e.jsxs("section",{className:"grid gap-6 lg:grid-cols-[1.15fr_0.85fr]",children:[e.jsx(o,{className:"rounded-3xl border border-gray-200 shadow-sm",children:e.jsxs(x,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-500",children:"Spend mix"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Where your money went"})]}),e.jsx(c,{variant:"outline",className:"rounded-full",children:"Download CSV"})]}),e.jsxs("div",{className:"flex flex-col gap-8 lg:flex-row lg:items-center",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"relative h-44 w-44",children:[e.jsxs("svg",{className:"h-full w-full",viewBox:"0 0 100 100",children:[e.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#10b981",strokeWidth:"12",strokeDasharray:"125 251",transform:"rotate(-90 50 50)"}),e.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#a5b4fc",strokeWidth:"12",strokeDasharray:"75 251",strokeDashoffset:"-125",transform:"rotate(-90 50 50)"}),e.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"12",strokeDasharray:"51 251",strokeDashoffset:"-200",transform:"rotate(-90 50 50)"})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-center",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n(r)})]})]})}),e.jsx("div",{className:"flex-1 space-y-4",children:["Rent","Food","Other"].map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"h-3 w-3 rounded-full",style:{backgroundColor:["#10b981","#a5b4fc","#94a3b8"][t]}}),e.jsx("span",{className:"text-gray-600",children:s})]}),e.jsx(u,{className:"h-4 w-4 text-gray-400"})]},s))})]})]})}),e.jsx(o,{className:"rounded-3xl border border-gray-200 shadow-sm",children:e.jsxs(x,{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-500",children:"Projection lab"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Financial projector"})]}),e.jsx("label",{className:"text-sm text-gray-600",children:"If I save an extra"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"৳"}),e.jsx("input",{type:"number",placeholder:"50",className:"w-full rounded-2xl border border-gray-200 py-3 pl-8 pr-4 text-sm focus:border-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"}),e.jsx(f,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-emerald-500"})]}),a.predictions&&e.jsxs("div",{className:"rounded-2xl border border-emerald-100 bg-emerald-50 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-emerald-700",children:"Projected savings"}),e.jsx("p",{className:"mt-3 text-3xl font-semibold text-emerald-900",children:n(a.predictions.month_end_total)}),e.jsxs("p",{className:"text-xs text-emerald-700 mt-1",children:[a.predictions.confidence," confidence"]})]}),e.jsx(c,{className:"rounded-full bg-blue-600 text-white hover:bg-blue-700",children:"Set new goal"})]})})]}),e.jsxs("section",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsx(o,{className:"rounded-3xl border border-gray-200 shadow-sm",children:e.jsxs(x,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-500",children:"Velocity"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Spending over time"})]}),e.jsx("div",{className:"rounded-full bg-gray-100 px-3 py-1 text-xs text-gray-600",children:"Trend view"})]}),e.jsxs("div",{className:"relative h-56",children:[e.jsxs("svg",{className:"h-full w-full",viewBox:"0 0 600 200",preserveAspectRatio:"none",children:[e.jsx("line",{x1:"0",y1:"100",x2:"600",y2:"100",stroke:"#e5e7eb",strokeDasharray:"5,5",strokeWidth:"1"}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"chartGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:"0.35"}),e.jsx("stop",{offset:"100%",stopColor:"#10b981",stopOpacity:"0.05"})]})}),e.jsx("path",{d:"M 0 180 L 100 160 L 200 140 L 300 110 L 400 120 L 500 90 L 600 60 L 600 200 L 0 200 Z",fill:"url(#chartGradient)"}),e.jsx("path",{d:"M 0 180 L 100 160 L 200 140 L 300 110 L 400 120 L 500 90 L 600 60",fill:"none",stroke:"#10b981",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:"600",cy:"60",r:"6",fill:"#10b981"}),e.jsx("circle",{cx:"600",cy:"60",r:"4",fill:"white"})]}),e.jsx("div",{className:"absolute bottom-2 left-0 right-0 flex justify-between px-2 text-xs text-gray-400",children:["Jul","Aug","Sep","Oct","Nov","Dec","Jan"].map(s=>e.jsx("span",{children:s},s))}),e.jsxs("div",{className:"absolute top-6 right-6 flex items-center gap-2 rounded-full bg-emerald-50 px-3 py-1 text-xs text-emerald-700",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-emerald-500"})," Travel spike - July"]})]})]})}),e.jsx(o,{className:"rounded-3xl border border-gray-200 shadow-sm",children:e.jsxs(x,{className:"space-y-4 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-500",children:"AI calls"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Actionable insights"})]}),e.jsx(c,{variant:"outline",className:"rounded-full px-4 py-1 text-sm",children:"Push to tasks"})]}),a.error&&e.jsxs("div",{className:"flex items-start gap-3 rounded-2xl border border-yellow-200 bg-yellow-50 p-4",children:[e.jsx(O,{className:"h-5 w-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-yellow-900 font-medium",children:"AI features limited"}),e.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:a.error})]})]}),a.insights&&a.insights.length>0?e.jsx("div",{className:"space-y-3",children:a.insights.slice(0,3).map((s,t)=>e.jsxs("div",{className:"flex items-start gap-3 rounded-2xl border border-red-100 bg-red-50 p-4",children:[e.jsx(A,{className:"h-5 w-5 text-red-600"}),e.jsx("p",{className:"text-sm text-gray-700",children:s.message})]},t))}):e.jsxs("div",{className:"flex items-start gap-3 rounded-2xl border border-gray-200 bg-gray-50 p-4",children:[e.jsx(u,{className:"h-5 w-5 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-600",children:"No actionable insights at this time. Keep tracking your expenses!"})]}),a.recommendations&&a.recommendations.length>0&&e.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:a.recommendations.slice(0,2).map((s,t)=>e.jsxs("div",{className:"rounded-2xl border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(P,{className:"h-5 w-5 text-gray-500"}),e.jsx("p",{className:"text-sm text-gray-700",children:s.action})]}),e.jsx(c,{variant:"ghost",className:"mt-4 w-full rounded-full text-sm",children:t===0?"Review & cancel":"Explore savings tips"})]},t))})]})})]})]}):e.jsx("div",{className:"max-w-7xl mx-auto py-20 text-center text-gray-500",children:"Unable to load AI telemetry right now. Try refreshing in a moment."})}export{z as AIInsightsPage};
