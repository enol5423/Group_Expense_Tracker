import{c as S,r as d,j as e,C as P,a as R,X as T,N as _,V as $,Y as q,B as C,x as U,w as O,u as V,v as A,y as Y,z as D,g as E,Z as X,_ as W,L as w,$ as Z,t as k,a0 as G,S as J,l as K,U as Q}from"./index-DwQK3muS.js";import{C as ee,F as se}from"./FriendList-BNcfCsRc.js";import{C as te,U as ae}from"./upload-BkYvSHL4.js";import{u as re}from"./select-B6NQ53IA.js";import{A as ne}from"./arrow-up-right-CsISBi3M.js";import"./dollar-sign-DGDz-2Nv.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],le=S("log-out",ie);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],oe=S("message-square",ce);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],xe=S("smartphone",de);function he({user:s,onLogout:n,onUpdateAvatar:t}){const[o,r]=d.useState(null),[x,l]=d.useState(!1),[a,i]=d.useState(!1),h=d.useRef(null),c=async p=>{const u=p.target.files?.[0];if(!u)return;const f=new FileReader;if(f.onload=g=>{r(g.target?.result)},f.readAsDataURL(u),t){l(!0);try{await t(u)}catch(g){console.error("Failed to upload avatar:",g),r(null)}finally{l(!1)}}i(!1)},b=()=>{r(null),i(!1)},m=o||s.avatarUrl;return e.jsx(P,{className:"border border-gray-200 shadow-sm",children:e.jsxs(R,{className:"p-8",children:[e.jsx("div",{className:"flex items-start justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:`w-20 h-20 rounded-full overflow-hidden ${m?"":"bg-emerald-100"} flex items-center justify-center cursor-pointer transition-all hover:ring-4 hover:ring-emerald-200`,onClick:()=>i(!a),children:[m?e.jsx("img",{src:m,alt:s.name,className:"w-full h-full object-cover"}):e.jsx(ee,{className:"h-12 w-12 text-emerald-600"}),x&&e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center rounded-full",children:e.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"})})]}),e.jsx("button",{className:"absolute -bottom-1 -right-1 p-1.5 bg-emerald-600 rounded-full text-white shadow-lg hover:bg-emerald-700 transition-colors",onClick:()=>h.current?.click(),children:e.jsx(te,{className:"h-3.5 w-3.5"})}),a&&e.jsxs("div",{className:"absolute top-full mt-2 left-0 bg-white rounded-xl shadow-lg border border-gray-200 py-2 z-10 min-w-[160px]",children:[e.jsxs("button",{className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",onClick:()=>h.current?.click(),children:[e.jsx(ae,{className:"h-4 w-4"}),"Upload photo"]}),m&&e.jsxs("button",{className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",onClick:b,children:[e.jsx(T,{className:"h-4 w-4"}),"Remove photo"]})]}),e.jsx("input",{ref:h,type:"file",accept:"image/*",className:"hidden",onChange:c})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl mb-1",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["@",s.username]})]})]})}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg",children:[e.jsx(_,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Email"}),e.jsx("p",{className:"text-sm",children:s.email})]})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg",children:[e.jsx($,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Phone"}),e.jsx("p",{className:"text-sm",children:s.phone})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg",children:[e.jsx(q,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Username"}),e.jsxs("p",{className:"text-sm",children:["@",s.username]})]})]})]}),e.jsxs(C,{variant:"outline",className:"w-full rounded-full border-red-300 text-red-600 hover:bg-red-50 hover:text-red-700 hover:border-red-400",onClick:n,children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Logout"]})]})})}var y="Switch",[me]=V(y),[ue,pe]=me(y),B=d.forwardRef((s,n)=>{const{__scopeSwitch:t,name:o,checked:r,defaultChecked:x,required:l,disabled:a,value:i="on",onCheckedChange:h,form:c,...b}=s,[m,p]=d.useState(null),u=U(n,N=>p(N)),f=d.useRef(!1),g=m?c||!!m.closest("form"):!0,[j,z]=O({prop:r,defaultProp:x??!1,onChange:h,caller:y});return e.jsxs(ue,{scope:t,checked:j,disabled:a,children:[e.jsx(A.button,{type:"button",role:"switch","aria-checked":j,"aria-required":l,"data-state":L(j),"data-disabled":a?"":void 0,disabled:a,value:i,...b,ref:u,onClick:Y(s.onClick,N=>{z(H=>!H),g&&(f.current=N.isPropagationStopped(),f.current||N.stopPropagation())})}),g&&e.jsx(I,{control:m,bubbles:!f.current,name:o,value:i,checked:j,required:l,disabled:a,form:c,style:{transform:"translateX(-100%)"}})]})});B.displayName=y;var F="SwitchThumb",M=d.forwardRef((s,n)=>{const{__scopeSwitch:t,...o}=s,r=pe(F,t);return e.jsx(A.span,{"data-state":L(r.checked),"data-disabled":r.disabled?"":void 0,...o,ref:n})});M.displayName=F;var fe="SwitchBubbleInput",I=d.forwardRef(({__scopeSwitch:s,control:n,checked:t,bubbles:o=!0,...r},x)=>{const l=d.useRef(null),a=U(l,x),i=re(t),h=D(n);return d.useEffect(()=>{const c=l.current;if(!c)return;const b=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(b,"checked").set;if(i!==t&&p){const u=new Event("click",{bubbles:o});p.call(c,t),c.dispatchEvent(u)}},[i,t,o]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...r,tabIndex:-1,ref:a,style:{...r.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});I.displayName=fe;function L(s){return s?"checked":"unchecked"}var ge=B,be=M;function v({className:s,...n}){return e.jsx(ge,{"data-slot":"switch",className:E("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-switch-background focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...n,children:e.jsx(be,{"data-slot":"switch-thumb",className:E("bg-card dark:data-[state=unchecked]:bg-card-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function je({userId:s,onSave:n}){const[t,o]=d.useState({...X,userId:s}),[r,x]=d.useState("default");d.useEffect(()=>{"Notification"in window&&x(Notification.permission)},[]);const l=h=>{o(c=>({...c,[h]:!c[h]}))},a=async()=>{const h=await Z.requestPermission();x(h),h==="granted"?(k.success("Push notifications enabled!"),o(c=>({...c,pushEnabled:!0}))):(k.error("Push notifications denied"),o(c=>({...c,pushEnabled:!1})))},i=()=>{G.setUserPreferences(s,t),n?.(t),k.success("Notification preferences saved!")};return e.jsx(P,{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Notification Preferences"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Choose how you want to receive notifications"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-500/10 flex items-center justify-center",children:e.jsx(W,{className:"w-5 h-5 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"in-app",className:"text-sm font-medium cursor-pointer",children:"In-App Notifications"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Show notifications within the app"})]})]}),e.jsx(v,{id:"in-app",checked:t.inAppEnabled,onCheckedChange:()=>l("inAppEnabled")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/10 flex items-center justify-center",children:e.jsx(xe,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"push",className:"text-sm font-medium cursor-pointer",children:"Push Notifications"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Browser push notifications",r==="denied"&&" (blocked by browser)"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r==="default"&&e.jsx(C,{size:"sm",variant:"outline",onClick:a,children:"Enable"}),r==="granted"&&e.jsx(v,{id:"push",checked:t.pushEnabled,onCheckedChange:()=>l("pushEnabled")}),r==="denied"&&e.jsx("span",{className:"text-xs text-red-500",children:"Blocked"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-500/10 flex items-center justify-center",children:e.jsx(_,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"email",className:"text-sm font-medium cursor-pointer",children:"Email Notifications"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Send important updates via email"})]})]}),e.jsx(v,{id:"email",checked:t.emailEnabled,onCheckedChange:()=>l("emailEnabled")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-500/10 flex items-center justify-center",children:e.jsx(oe,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"sms",className:"text-sm font-medium cursor-pointer",children:"SMS Notifications"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Urgent alerts via text message"})]})]}),e.jsx(v,{id:"sms",checked:t.smsEnabled,onCheckedChange:()=>l("smsEnabled")})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsx(C,{onClick:i,className:"w-full",children:"Save Preferences"})}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/20 p-4 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:[e.jsx("strong",{children:"Note:"})," High priority notifications may still be sent through multiple channels regardless of your preferences to ensure important updates reach you."]})})]})})}function Se({user:s,friends:n,loading:t,onLogout:o,onSettle:r}){const x=n.reduce((a,i)=>(i.balance>0&&(a.owed+=i.balance),i.balance<0&&(a.owing+=Math.abs(i.balance)),a),{owed:0,owing:0}),l=[{label:"Crew members",value:n.length},{label:"You are owed",value:`৳${x.owed.toFixed(0)}`},{label:"You owe",value:`৳${x.owing.toFixed(0)}`}];return e.jsxs("div",{className:"max-w-7xl mx-auto space-y-10 pb-16",children:[e.jsx("section",{className:"rounded-[36px] bg-gradient-to-br from-gray-900 via-slate-900 to-emerald-900 p-10 text-white",children:e.jsxs("div",{className:"flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-white/20 px-4 py-1 text-xs uppercase tracking-[0.4em] text-white/60",children:[e.jsx(J,{className:"h-4 w-4"}),"Profile"]}),e.jsx("h1",{className:"mt-3 text-4xl font-semibold",children:s.name}),e.jsx("p",{className:"mt-2 text-white/70",children:s.email}),s.username&&e.jsxs("p",{className:"text-sm text-white/60",children:["@",s.username]})]}),e.jsx("div",{className:"grid w-full max-w-sm gap-4",children:l.map(a=>e.jsxs("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-white/60",children:a.label}),e.jsx("p",{className:"mt-3 text-2xl font-semibold",children:a.value})]},a.label))})]})}),e.jsxs("section",{className:"grid gap-6 lg:grid-cols-[1.1fr_0.9fr]",children:[e.jsx("div",{className:"rounded-[28px] border border-gray-200 bg-white p-4 shadow-lg",children:e.jsx(he,{user:s,onLogout:o})}),e.jsx("div",{className:"rounded-[28px] border border-gray-200 bg-white p-4 shadow-sm",children:e.jsx(je,{userId:s.id})})]}),e.jsxs(P,{className:"rounded-[32px] border border-gray-200 shadow-lg",children:[e.jsx(K,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-2xl bg-emerald-100 p-3",children:e.jsx(Q,{className:"h-6 w-6 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Friend ledger"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[n.length," ",n.length===1?"friend":"friends"," connected"]})]}),e.jsxs("div",{className:"ml-auto flex items-center gap-2 text-sm text-gray-500",children:[e.jsx(ne,{className:"h-4 w-4"}),x.owed>x.owing?"Net positive":"Review debts"]})]})}),e.jsx(R,{children:t?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading friends..."}):e.jsx(se,{friends:n,onSettle:r})})]})]})}export{Se as ProfilePage};
