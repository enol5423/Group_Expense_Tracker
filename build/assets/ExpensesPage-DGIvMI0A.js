import{c as te,r as h,j as e,g as ys,h as ge,C as $,e as T,B as I,S as oe,T as He,L as B,I as G,t as X,f as Ns,i as vs,k as ws,l as Cs,m as Ue,u as Ae,n as qe,P as re,o as Ye,p as As,q as Ge,s as ks,R as O,v as Ss}from"./index-CRIiYYAI.js";import{g as W,e as ee}from"./ExpenseCategories-DZnYnuOl.js";import{T as ie}from"./trending-up-BAi8RDrt.js";import{T as Ds}from"./trending-down-Cnl1QEcd.js";import{T as se}from"./triangle-alert-CYnw1tlq.js";import{T as Ps,C as Is}from"./target-D9y72uOD.js";import{R as Ms,S as Rs,U as Fs,V as Es,O as _s}from"./PieChart-DuuSnN-L.js";import{D as ce,a as de,b as xe,c as me,d as ue,S as ke,e as Se,f as De,g as Pe,h as Ie,i as $s,C as Ts}from"./select-DOzGwCYW.js";import{P as Ke,A as Os,a as Ls,b as Bs,c as zs,d as Vs,e as Hs,f as Us,g as qs,h as Ys,T as Gs}from"./textarea-Dl408mrp.js";import{D as Le}from"./download-4AW0JUmb.js";import"./utensils-9D_zl73m.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Be=te("camera",Ks);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ws=te("chevron-left",Js);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Qs=te("chevron-right",Xs);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Je=te("circle-check",Zs);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],st=te("file-text",et);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],We=te("upload",tt);function at(s,a=[]){let c=[];function n(t,l){const d=h.createContext(l);d.displayName=t+"Context";const o=c.length;c=[...c,l];const f=j=>{const{scope:b,children:p,...x}=j,u=b?.[s]?.[o]||d,g=h.useMemo(()=>x,Object.values(x));return e.jsx(u.Provider,{value:g,children:p})};f.displayName=t+"Provider";function C(j,b){const p=b?.[s]?.[o]||d,x=h.useContext(p);if(x)return x;if(l!==void 0)return l;throw new Error(`\`${j}\` must be used within \`${t}\``)}return[f,C]}const r=()=>{const t=c.map(l=>h.createContext(l));return function(d){const o=d?.[s]||t;return h.useMemo(()=>({[`__scope${s}`]:{...d,[s]:o}}),[d,o])}};return r.scopeName=s,[n,rt(r,...a)]}function rt(...s){const a=s[0];if(s.length===1)return a;const c=()=>{const n=s.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(t){const l=n.reduce((d,{useScope:o,scopeName:f})=>{const j=o(t)[`__scope${f}`];return{...d,...j}},{});return h.useMemo(()=>({[`__scope${a.scopeName}`]:l}),[l])}};return c.scopeName=a.scopeName,c}var nt=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Xe=nt.reduce((s,a)=>{const c=ys(`Primitive.${a}`),n=h.forwardRef((r,t)=>{const{asChild:l,...d}=r,o=l?c:a;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(o,{...d,ref:t})});return n.displayName=`Primitive.${a}`,{...s,[a]:n}},{}),Me="Progress",Re=100,[lt]=at(Me),[ot,it]=lt(Me),Qe=h.forwardRef((s,a)=>{const{__scopeProgress:c,value:n=null,max:r,getValueLabel:t=ct,...l}=s;(r||r===0)&&!ze(r)&&console.error(dt(`${r}`,"Progress"));const d=ze(r)?r:Re;n!==null&&!Ve(n,d)&&console.error(xt(`${n}`,"Progress"));const o=Ve(n,d)?n:null,f=he(o)?t(o,d):void 0;return e.jsx(ot,{scope:c,value:o,max:d,children:e.jsx(Xe.div,{"aria-valuemax":d,"aria-valuemin":0,"aria-valuenow":he(o)?o:void 0,"aria-valuetext":f,role:"progressbar","data-state":ss(o,d),"data-value":o??void 0,"data-max":d,...l,ref:a})})});Qe.displayName=Me;var Ze="ProgressIndicator",es=h.forwardRef((s,a)=>{const{__scopeProgress:c,...n}=s,r=it(Ze,c);return e.jsx(Xe.div,{"data-state":ss(r.value,r.max),"data-value":r.value??void 0,"data-max":r.max,...n,ref:a})});es.displayName=Ze;function ct(s,a){return`${Math.round(s/a*100)}%`}function ss(s,a){return s==null?"indeterminate":s===a?"complete":"loading"}function he(s){return typeof s=="number"}function ze(s){return he(s)&&!isNaN(s)&&s>0}function Ve(s,a){return he(s)&&!isNaN(s)&&s<=a&&s>=0}function dt(s,a){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${a}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Re}\`.`}function xt(s,a){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${a}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Re} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var mt=Qe,ut=es;function ts({className:s,value:a,...c}){return e.jsx(mt,{"data-slot":"progress",className:ge("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",s),...c,children:e.jsx(ut,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})})}function ht({expenses:s,budgets:a,stats:c}){const n=new Date,r=n.getMonth(),t=n.getFullYear(),l=Array.isArray(s)?s:[],d=Array.isArray(a)?a:[],o=l.filter(y=>{const v=new Date(y.createdAt);return v.getMonth()===r&&v.getFullYear()===t}),f=o.reduce((y,v)=>y+v.amount,0),C={};o.forEach(y=>{const v=y.category||"other";C[v]||(C[v]={amount:0,count:0}),C[v].amount+=y.amount,C[v].count+=1});const j=Object.entries(C).map(([y,v])=>{const K=W(y);return{name:K.label,value:v.amount,count:v.count,color:K.color}}).sort((y,v)=>v.value-y.value),b=["#10b981","#3b82f6","#8b5cf6","#f59e0b","#ec4899","#06b6d4","#ef4444","#6b7280"],p=d.filter(y=>y.month===r&&y.year===t).reduce((y,v)=>y+v.limit,0),x=p>0?f/p*100:0,u=x>100,g=x>80&&x<=100,N=r===0?11:r-1,w=r===0?t-1:t,k=l.filter(y=>{const v=new Date(y.createdAt);return v.getMonth()===N&&v.getFullYear()===w}).reduce((y,v)=>y+v.amount,0),E=k>0?(f-k)/k*100:0,_=["January","February","March","April","May","June","July","August","September","October","November","December"];return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 items-stretch",children:[e.jsx($,{className:"h-full border-0 shadow-md bg-gradient-to-br from-emerald-100 via-teal-50 to-cyan-50 rounded-[28px]",children:e.jsx(T,{className:"p-8 lg:p-10 flex flex-col justify-center h-full",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-emerald-600/70",children:"Monthly pulse"}),e.jsxs("div",{className:"text-5xl lg:text-6xl text-gray-800 leading-tight mt-4",children:["à§³",f.toFixed(0)]}),e.jsxs("div",{className:"text-base lg:text-lg text-gray-700 mt-2",children:[_[r]," Spending"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:E!==0&&e.jsxs("div",{className:`flex items-center gap-2 text-sm ${E>0?"text-red-600":"text-emerald-600"}`,children:[E>0?e.jsx(ie,{className:"h-4 w-4"}):e.jsx(Ds,{className:"h-4 w-4"}),e.jsxs("span",{className:"font-medium",children:[Math.abs(E).toFixed(1),"% vs last month"]})]})}),e.jsxs("p",{className:"text-sm text-gray-600",children:[o.length," ",o.length===1?"transaction":"transactions"]})]})})}),e.jsx($,{className:`h-full border shadow-sm rounded-[28px] ${u?"border-red-200 bg-red-50":g?"border-yellow-200 bg-yellow-50":"border-gray-200 bg-white"}`,children:e.jsxs(T,{className:"p-8 lg:p-10 flex flex-col justify-center h-full space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm uppercase tracking-[0.3em] text-gray-500",children:"Budget progress"}),u?e.jsx(se,{className:"h-5 w-5 text-red-600"}):g?e.jsx(se,{className:"h-5 w-5 text-yellow-600"}):e.jsx(Ps,{className:"h-5 w-5 text-gray-400"})]}),p>0?e.jsxs("div",{className:"space-y-4 text-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl mb-1",children:[x.toFixed(0),"%"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["à§³",f.toFixed(0)," / à§³",p.toFixed(0)]})]}),e.jsx(ts,{value:Math.min(x,100),className:`h-2 ${u?"bg-red-200":g?"bg-yellow-200":"bg-gray-200"}`}),u&&e.jsxs("p",{className:"text-xs text-red-600",children:["Over budget by à§³",(f-p).toFixed(0)]}),g&&e.jsx("p",{className:"text-xs text-yellow-600",children:"Approaching budget limit"}),!u&&!g&&e.jsxs("p",{className:"text-xs text-gray-500",children:["à§³",(p-f).toFixed(0)," remaining"]})]}):e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("p",{className:"text-sm text-gray-500",children:"No budget set"})})]})}),e.jsx($,{className:"h-full border border-gray-200 shadow-sm rounded-[28px]",children:e.jsxs(T,{className:"p-8 lg:p-10 flex flex-col justify-center h-full space-y-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm uppercase tracking-[0.3em] text-gray-500",children:"Top categories"}),e.jsx("h3",{className:"font-semibold text-lg mt-2",children:"Where spend concentrates"})]}),j.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"relative w-28 h-28",children:[e.jsx(Ms,{width:"100%",height:"100%",children:e.jsx(Rs,{children:e.jsx(Fs,{data:j,cx:"50%",cy:"50%",innerRadius:36,outerRadius:52,paddingAngle:2,dataKey:"value",strokeWidth:0,children:j.map((y,v)=>e.jsx(Es,{fill:b[v%b.length]},`cell-${v}`))})})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:j.length}),e.jsx("div",{className:"text-xs text-gray-500",children:"cats"})]})})]})}),e.jsx("div",{className:"space-y-3",children:j.slice(0,3).map((y,v)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:b[v%b.length]}}),e.jsx("span",{className:"text-gray-600",children:y.name})]}),e.jsxs("span",{className:"font-medium",children:["à§³",y.value.toFixed(0)]})]},v))})]}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-sm text-gray-500",children:"No expenses this month"})})]})})]})}function pt({budgets:s,expenses:a,onCreateBudget:c,onDeleteBudget:n}){const[r,t]=h.useState(!1),[l,d]=h.useState(!1),[o,f]=h.useState(!1),[C,j]=h.useState(""),[b,p]=h.useState(null),[x,u]=h.useState([]),[g,N]=h.useState({category:"food",limit:""}),w=new Date,A=w.getMonth(),k=w.getFullYear(),E=Array.isArray(s)?s:[],_=Array.isArray(a)?a:[],y=E.filter(i=>i.month===A&&i.year===k),v=_.filter(i=>{const m=new Date(i.createdAt);return m.getMonth()===A&&m.getFullYear()===k}),K={};v.forEach(i=>{const m=i.category||"other";K[m]=(K[m]||0)+i.amount});const ye=async i=>{if(i.preventDefault(),!(!g.category||!g.limit)){f(!0);try{await c({category:g.category,limit:parseFloat(g.limit),month:A,year:k}),N({category:"food",limit:""}),t(!1),X.success("Budget created successfully!")}catch(m){console.error("Failed to create budget:",m),X.error("Failed to create budget")}finally{f(!1)}}},J={food:.2,groceries:.1,housing:.15,utilities:.1,transport:.1,entertainment:.1,healthcare:.05,travel:.05,gifts:.05,other:.1},ne=(i,m)=>{const D=new Date,R=new Date;R.setMonth(D.getMonth()-3);const M=_.filter(F=>{const P=new Date(F.createdAt);return P>=R&&P<D});if(M.length===0){const F={},U=Object.entries(J).filter(([V])=>m.includes(V)).reduce((V,[q,Y])=>V+Y,0);return m.forEach(V=>{const q=J[V]||0,Y=U>0?q/U:1/m.length;F[V]=i*Y}),{distribution:F,isDefault:!0,monthsAnalyzed:0,selectedCategories:m}}const z={};M.forEach(F=>{const P=F.category||"other";m.includes(P)&&(z[P]=(z[P]||0)+F.amount)});const ae=Object.values(z).reduce((F,P)=>F+P,0),Z={};if(ae>0){m.forEach(P=>{if(z[P]){const U=z[P]/ae;Z[P]=i*U}else Z[P]=0});const F=m.filter(P=>!z[P]);if(F.length>0){const P=Object.values(Z).reduce((q,Y)=>q+Y,0),U=i-P,V=F.reduce((q,Y)=>q+(J[Y]||0),0);F.forEach(q=>{const Y=J[q]||1/F.length,bs=V>0?Y/V:1/F.length;Z[q]=U*bs})}}else{const F=m.reduce((P,U)=>P+(J[U]||0),0);m.forEach(P=>{const U=J[P]||1/m.length,V=F>0?U/F:1/m.length;Z[P]=i*V})}return{distribution:Z,isDefault:!1,monthsAnalyzed:3,totalSpent:ae,expenseCount:M.length,selectedCategories:m}},Ne=()=>{const i=parseFloat(C);if(isNaN(i)||i<=0){X.error("Please enter a valid total budget amount");return}if(x.length===0){X.error("Please select at least one category");return}const m=y.filter(R=>x.includes(R.category)).map(R=>W(R.category).label);if(m.length>0){X.error(`Budgets already exist for: ${m.join(", ")}. Please remove them first or deselect these categories.`);return}const D=ne(i,x);p(D)},Q=i=>{u(m=>m.includes(i)?m.filter(D=>D!==i):[...m,i])},le=()=>{const i=S().map(m=>m.id);x.length===i.length?u([]):u(i)},S=()=>{const i=y.map(m=>m.category);return ee.filter(m=>!i.includes(m.id))},L=async()=>{if(b){f(!0);try{const i=Object.entries(b.distribution).map(([m,D])=>D>0?c({category:m,limit:D,month:A,year:k}):Promise.resolve());await Promise.all(i),X.success(`Successfully created budgets for ${Object.keys(b.distribution).filter(m=>b.distribution[m]>0).length} categories!`),d(!1),j(""),p(null)}catch(i){console.error("Failed to create budgets:",i),X.error("Failed to create budgets")}finally{f(!1)}}},ve=["January","February","March","April","May","June","July","August","September","October","November","December"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Budget Management"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Set spending limits for ",ve[A]]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(I,{onClick:()=>t(!0),className:"bg-blue-500 hover:bg-blue-600 text-white rounded-full",children:[e.jsx(Ke,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Add Budget"})]}),e.jsxs(I,{onClick:()=>d(!0),className:"bg-emerald-500 hover:bg-emerald-600 text-white rounded-full",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Auto-Distribute"})]})]}),y.length===0?e.jsx($,{className:"border border-gray-200 shadow-sm",children:e.jsx(T,{className:"py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(se,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-600",children:"No budgets set for this month"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create a budget to track your spending"})]})})}):e.jsx("div",{className:"grid gap-3",children:y.map(i=>{const m=K[i.category]||0,D=m/i.limit*100,R=D>100,M=D>80&&D<=100,z=W(i.category),ae=z.icon;return e.jsx($,{className:`border shadow-sm ${R?"border-red-200 bg-red-50":M?"border-yellow-200 bg-yellow-50":"border-gray-200"}`,children:e.jsxs(T,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white border border-gray-200",children:e.jsx(ae,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:z.label}),e.jsxs("p",{className:"text-sm text-gray-600",children:["à§³",m.toFixed(0)," / à§³",i.limit.toFixed(0)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[R?e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-red-600",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:"Over Budget"})]}):M?e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-yellow-600",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:"Near Limit"})]}):e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-emerald-600",children:[e.jsx(Je,{className:"h-4 w-4"}),e.jsx("span",{children:"On Track"})]}),e.jsx(I,{variant:"ghost",size:"icon",onClick:()=>n(i.id),className:"rounded-full hover:bg-red-50 hover:text-red-600",children:e.jsx(He,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ts,{value:Math.min(D,100),className:`h-2 ${R?"bg-red-200":M?"bg-yellow-200":"bg-gray-200"}`}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[e.jsxs("span",{children:[D.toFixed(0),"% used"]}),e.jsxs("span",{children:["à§³",Math.max(i.limit-m,0).toFixed(0)," remaining"]})]})]})]})},i.id)})}),e.jsx(ce,{open:l,onOpenChange:i=>{d(i),i||(j(""),p(null),u([]))},children:e.jsxs(de,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(xe,{children:[e.jsxs(me,{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-5 w-5 text-emerald-600"}),"Auto-Distribute Budget"]}),e.jsxs(ue,{children:["Select categories, enter your total monthly budget, and we'll automatically distribute it",b&&(b.isDefault?" using smart defaults (no transaction history found)":` based on your last 3 months of spending (${b.expenseCount} transactions analyzed)`)]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(B,{children:"Select Categories *"}),e.jsx(I,{type:"button",variant:"ghost",size:"sm",onClick:le,className:"text-xs rounded-full",children:x.length===ee.length?"Deselect All":"Select All Available"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 p-4 bg-gray-50 rounded-lg max-h-64 overflow-y-auto",children:ee.map(i=>{const m=y.some(M=>M.category===i.id),D=x.includes(i.id),R=i.icon;return e.jsxs("div",{onClick:()=>!m&&Q(i.id),className:`flex items-center gap-2 p-3 rounded-lg border transition-all cursor-pointer ${m?"bg-gray-100 border-gray-300 opacity-50 cursor-not-allowed":D?"bg-emerald-50 border-emerald-500":"bg-white border-gray-200 hover:border-emerald-300"}`,children:[e.jsx("input",{type:"checkbox",checked:D,disabled:m,onChange:()=>{},className:"h-4 w-4 rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),e.jsx("div",{className:"p-2 rounded-lg bg-white border border-gray-200",children:e.jsx(R,{className:"h-4 w-4 text-gray-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:i.label}),m&&e.jsx("p",{className:"text-xs text-gray-500",children:"Already exists"})]})]},i.id)})}),x.length>0&&e.jsxs("p",{className:"text-sm text-gray-600",children:[x.length," ",x.length===1?"category":"categories"," selected"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"totalBudget",children:"Total Monthly Budget *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(G,{id:"totalBudget",type:"number",step:"0.01",min:"0",placeholder:"50000.00",value:C,onChange:i=>j(i.target.value),className:"flex-1"}),e.jsxs(I,{onClick:Ne,className:"bg-emerald-500 hover:bg-emerald-600 text-white rounded-full",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Calculate"]})]})]}),b&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg bg-emerald-50 border border-emerald-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-emerald-900",children:b.isDefault?"ðŸ“Š Default Distribution":"ðŸŽ¯ Smart Distribution"}),e.jsx("p",{className:"text-sm text-emerald-700",children:b.isDefault?"Using balanced defaults for new users":`Based on à§³${b.totalSpent.toFixed(2)} spent over ${b.monthsAnalyzed} months`})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl text-emerald-900",children:["à§³",parseFloat(C).toFixed(0)]}),e.jsx("p",{className:"text-xs text-emerald-600",children:"Total Budget"})]})]}),e.jsx("div",{className:"grid gap-3 max-h-96 overflow-y-auto",children:Object.entries(b.distribution).filter(([i,m])=>m>0).sort((i,m)=>m[1]-i[1]).map(([i,m])=>{const D=W(i),R=D.icon,M=m/parseFloat(C)*100;return e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg bg-white border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gray-50 border border-gray-200",children:e.jsx(R,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:D.label}),e.jsxs("p",{className:"text-xs text-gray-600",children:[M.toFixed(1),"% of total budget"]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-medium",children:["à§³",m.toFixed(0)]})})]},i)})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>{d(!1),j(""),p(null),u([])},disabled:o,className:"rounded-full",children:"Cancel"}),e.jsx(I,{onClick:L,disabled:!b||o,className:"bg-emerald-500 hover:bg-emerald-600 text-white rounded-full",children:o?"Creating...":"Apply Distribution"})]})]})]})}),e.jsx(ce,{open:r,onOpenChange:t,children:e.jsxs(de,{children:[e.jsxs(xe,{children:[e.jsx(me,{children:"Create Budget"}),e.jsx(ue,{children:"Set a spending limit for a specific category to help manage your finances."})]}),e.jsxs("form",{onSubmit:ye,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"category",children:"Category *"}),e.jsxs(ke,{value:g.category,onValueChange:i=>N({...g,category:i}),children:[e.jsx(Se,{children:e.jsx(De,{})}),e.jsx(Pe,{children:ee.map(i=>e.jsx(Ie,{value:i.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i.icon,{className:`h-4 w-4 ${i.color}`}),e.jsx("span",{children:i.label})]})},i.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"limit",children:"Monthly Limit *"}),e.jsx(G,{id:"limit",type:"number",step:"0.01",min:"0",placeholder:"500.00",value:g.limit,onChange:i=>N({...g,limit:i.target.value}),required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>t(!1),disabled:o,className:"rounded-full",children:"Cancel"}),e.jsx(I,{type:"submit",disabled:o,className:"bg-blue-500 hover:bg-blue-600 text-white rounded-full",children:o?"Creating...":"Create Budget"})]})]})]})})]})}const we=20,gt=h.memo(function({expenses:a,onDelete:c}){const[n,r]=h.useState(1),t=Array.isArray(a)?a:[],l=h.useMemo(()=>[...t].sort((j,b)=>new Date(b.createdAt).getTime()-new Date(j.createdAt).getTime()),[t]),d=Math.ceil(l.length/we),o=(n-1)*we,f=o+we,C=l.slice(o,f);return t.length===0?e.jsx($,{className:"border border-gray-200 shadow-sm",children:e.jsx(T,{className:"py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ns,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-600",children:"No expenses yet"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Add your first expense to get started"})]})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-3",children:C.map(j=>{const b=W(j.category||"other"),p=b.icon;return e.jsx($,{className:"border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white border border-gray-200",children:e.jsx(p,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"font-medium text-gray-900 truncate",children:j.description}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-gray-200 text-gray-700 whitespace-nowrap",children:b.label})]}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(j.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),j.notes&&e.jsxs("div",{className:"flex items-start gap-2 mt-2",children:[e.jsx(st,{className:"h-3 w-3 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-gray-600",children:j.notes})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 ml-4",children:[e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-lg font-medium text-gray-900",children:["à§³",j.amount.toFixed(2)]})}),e.jsxs(Os,{children:[e.jsx(Ls,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-red-50 hover:text-red-600",children:e.jsx(He,{className:"h-4 w-4"})})}),e.jsxs(Bs,{children:[e.jsxs(zs,{children:[e.jsx(Vs,{children:"Delete Expense"}),e.jsx(Hs,{children:"Are you sure you want to delete this expense? This action cannot be undone."})]}),e.jsxs(Us,{children:[e.jsx(qs,{children:"Cancel"}),e.jsx(Ys,{onClick:()=>c(j.id),className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})]})]})]})})},j.id)})}),d>1&&e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-200",children:[e.jsxs(I,{variant:"ghost",size:"sm",className:"rounded-full",disabled:n===1,onClick:()=>r(n-1),children:[e.jsx(Ws,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Page ",n," of ",d," â€¢ ",l.length," total expenses"]}),e.jsxs(I,{variant:"ghost",size:"sm",className:"rounded-full",disabled:n===d,onClick:()=>r(n+1),children:["Next",e.jsx(Qs,{className:"h-4 w-4 ml-1"})]})]})]})});function ft({open:s,onOpenChange:a,onCreate:c}){const[n,r]=h.useState(!1),[t,l]=h.useState({description:"",amount:"",category:"other",notes:""}),d=async o=>{if(o.preventDefault(),!(!t.description||!t.amount)){r(!0);try{await c({description:t.description,amount:parseFloat(t.amount),category:t.category,notes:t.notes}),l({description:"",amount:"",category:"other",notes:""}),a(!1)}catch(f){console.error("Failed to create expense:",f)}finally{r(!1)}}};return e.jsx(ce,{open:s,onOpenChange:a,children:e.jsxs(de,{className:"sm:max-w-[500px]",children:[e.jsxs(xe,{children:[e.jsx(me,{children:"Add Expense"}),e.jsx(ue,{children:"Track a new personal expense by filling out the details below."})]}),e.jsxs("form",{onSubmit:d,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"description",children:"Description *"}),e.jsx(G,{id:"description",placeholder:"Coffee, groceries, etc.",value:t.description,onChange:o=>l({...t,description:o.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"amount",children:"Amount *"}),e.jsx(G,{id:"amount",type:"number",step:"0.01",min:"0",placeholder:"0.00",value:t.amount,onChange:o=>l({...t,amount:o.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"category",children:"Category"}),e.jsxs(ke,{value:t.category,onValueChange:o=>l({...t,category:o}),children:[e.jsx(Se,{children:e.jsx(De,{})}),e.jsx(Pe,{children:ee.map(o=>e.jsx(Ie,{value:o.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o.icon,{className:`h-4 w-4 ${o.color}`}),e.jsx("span",{children:o.label})]})},o.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"notes",children:"Notes"}),e.jsx(Gs,{id:"notes",placeholder:"Add any additional details...",value:t.notes,onChange:o=>l({...t,notes:o.target.value}),rows:3})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>a(!1),disabled:n,children:"Cancel"}),e.jsx(I,{type:"submit",disabled:n,className:"bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 text-white",children:n?"Adding...":"Add Expense"})]})]})]})})}function jt({open:s,onOpenChange:a,onScan:c,onCreate:n}){const[r,t]=h.useState(!1),[l,d]=h.useState(null),[o,f]=h.useState(null),[C,j]=h.useState(null),b=async u=>{const g=u.target.files?.[0];if(g){if(!g.type.startsWith("image/")){f("Please select an image file");return}j(g),t(!0),f(null),d(null);try{const N=new FileReader,A=await new Promise((E,_)=>{N.onload=()=>E(N.result),N.onerror=_,N.readAsDataURL(g)}),k=await c(g);if(k&&k.amount!==void 0)d({description:k.description||"Receipt scan",amount:k.amount.toFixed(2),category:k.category||"other",notes:k.notes||`Scanned from ${g.name}`});else throw new Error("Invalid response from receipt scanner")}catch(N){console.error("Receipt scanning error:",N),f(N.message||"Failed to scan receipt. Please try again or enter details manually.")}finally{t(!1)}}},p=async()=>{if(l)try{await n({description:l.description,amount:parseFloat(l.amount),category:l.category,notes:l.notes}),x()}catch(u){console.error("Failed to create expense:",u)}},x=()=>{t(!1),d(null),f(null),j(null),a(!1)};return e.jsx(ce,{open:s,onOpenChange:x,children:e.jsxs(de,{className:"sm:max-w-[600px]",children:[e.jsxs(xe,{children:[e.jsxs(me,{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-5 w-5"}),"AI Receipt Scanner"]}),e.jsx(ue,{children:"Upload a receipt image and let AI automatically extract the expense details."})]}),!l&&!r&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-2xl p-12 text-center hover:border-emerald-500 transition-colors",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"p-6 rounded-full bg-gradient-to-br from-purple-500 to-pink-600",children:e.jsx(We,{className:"h-12 w-12 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Upload Receipt"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"AI will automatically extract amount and categorize"}),e.jsx(G,{type:"file",accept:"image/*",onChange:b,className:"max-w-xs mx-auto"})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-950 dark:to-pink-950 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-500/20",children:e.jsx(Be,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-purple-900 dark:text-purple-100 mb-1",children:"Smart AI Features"}),e.jsxs("ul",{className:"text-sm text-purple-700 dark:text-purple-300 space-y-1",children:[e.jsx("li",{children:"â€¢ Automatic amount extraction"}),e.jsx("li",{children:"â€¢ Intelligent category suggestion"}),e.jsx("li",{children:"â€¢ Date recognition"}),e.jsx("li",{children:"â€¢ Merchant name detection"})]})]})]})}),o&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 bg-red-50 dark:bg-red-950 p-4 rounded-xl",children:[e.jsx(se,{className:"h-5 w-5"}),e.jsx("span",{children:o})]})]}),r&&e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("div",{className:"inline-flex p-6 rounded-full bg-gradient-to-br from-purple-500 to-pink-600 mb-6",children:e.jsx(vs,{className:"h-12 w-12 text-white animate-spin"})}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Scanning Receipt..."}),e.jsx("p",{className:"text-muted-foreground",children:"AI is analyzing your receipt"})]}),l&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 text-green-600 bg-green-50 dark:bg-green-950 p-4 rounded-xl",children:[e.jsx(Je,{className:"h-6 w-6"}),e.jsx("span",{className:"font-medium",children:"Receipt scanned successfully!"})]}),e.jsx($,{className:"border-2 border-emerald-200 bg-white",children:e.jsxs(T,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Description"}),e.jsx(G,{value:l.description,onChange:u=>d({...l,description:u.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Amount"}),e.jsx(G,{type:"number",step:"0.01",value:l.amount,onChange:u=>d({...l,amount:u.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Category (AI Suggested)"}),e.jsxs(ke,{value:l.category,onValueChange:u=>d({...l,category:u}),children:[e.jsx(Se,{children:e.jsx(De,{})}),e.jsx(Pe,{children:ee.map(u=>e.jsx(Ie,{value:u.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u.icon,{className:`h-4 w-4 ${u.color}`}),e.jsx("span",{children:u.label})]})},u.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Notes"}),e.jsx(G,{value:l.notes,onChange:u=>d({...l,notes:u.target.value})})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(I,{variant:"outline",onClick:x,children:"Cancel"}),e.jsx(I,{onClick:p,className:"bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 text-white",children:"Add Expense"})]})]})]})})}function bt({onSearch:s}){const[a,c]=h.useState(""),[n,r]=h.useState(null),[t,l]=h.useState(!1),[d,o]=h.useState(!1),f=async p=>{if(c(p),!p.trim()){r(null),o(!1);return}l(!0),o(!0);try{const x=await s(p);r(x)}catch(x){console.error("Search failed:",x),r(null)}finally{l(!1)}},C=["coffee expenses","how much on food?","groceries last week","compare food vs transport","spending trend","total this month"],j=p=>{const{analysisResult:x,explanation:u}=p.data;return e.jsxs("div",{className:"space-y-4",children:[u&&e.jsx("div",{className:"bg-purple-50 dark:bg-purple-950 border border-purple-200 dark:border-purple-800 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(oe,{className:"h-5 w-5 text-purple-600 dark:text-purple-400 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-purple-900 dark:text-purple-100",children:u})]})}),x.text&&e.jsx($,{className:"border-2 border-emerald-200 bg-white",children:e.jsx(T,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-emerald-500/20",children:e.jsx(_s,{className:"h-6 w-6 text-emerald-600 dark:text-emerald-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-emerald-900 dark:text-emerald-100 mb-2",children:"Analysis Result"}),e.jsx("p",{className:"text-lg text-emerald-800 dark:text-emerald-200",children:x.text})]})]})})}),x.breakdown&&e.jsx($,{children:e.jsxs(T,{className:"p-6",children:[e.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Cs,{className:"h-5 w-5"}),"Category Breakdown"]}),e.jsx("div",{className:"space-y-3",children:Object.entries(x.breakdown).map(([g,N])=>{const w=W(g),A=w.icon,k=N.total/Object.values(x.breakdown).reduce((E,_)=>E+_.total,0)*100;return e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${w.bgColor}`,children:e.jsx(A,{className:`h-4 w-4 ${w.color}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium capitalize",children:g}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[N.count," expenses"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold",children:["à§³",N.total.toFixed(2)]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[k.toFixed(1),"%"]})]})]},g)})})]})}),x.category1&&e.jsx($,{children:e.jsxs(T,{className:"p-6",children:[e.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"Comparison"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800",children:[e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400 mb-1 capitalize",children:x.category1.name}),e.jsxs("p",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:["à§³",x.category1.total.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:[x.category1.count," expenses"]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-purple-50 dark:bg-purple-950 border border-purple-200 dark:border-purple-800",children:[e.jsx("p",{className:"text-sm text-purple-600 dark:text-purple-400 mb-1 capitalize",children:x.category2.name}),e.jsxs("p",{className:"text-2xl font-bold text-purple-900 dark:text-purple-100",children:["à§³",x.category2.total.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-purple-600 dark:text-purple-400 mt-1",children:[x.category2.count," expenses"]})]})]}),x.percentage!==void 0&&e.jsx("div",{className:"mt-4 p-3 rounded-lg bg-gray-50 text-center",children:e.jsxs("p",{className:"text-sm",children:[e.jsxs("span",{className:"font-semibold",children:[Math.abs(x.percentage).toFixed(1),"%"]}),x.difference>0?" more":" less"]})})]})}),x.monthlyData&&e.jsx($,{children:e.jsxs(T,{className:"p-6",children:[e.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"Monthly Trend"]}),e.jsx("div",{className:"space-y-2",children:Object.entries(x.monthlyData).map(([g,N])=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gray-50",children:[e.jsx("span",{className:"font-medium",children:g}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold",children:["à§³",N.total.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[N.count," expenses"]})]})]},g))})]})}),p.data.expenses&&p.data.expenses.length>0&&e.jsx($,{children:e.jsxs(T,{className:"p-6",children:[e.jsxs("h4",{className:"font-semibold mb-4",children:["Related Expenses (",p.data.expenses.length,")"]}),e.jsx("div",{className:"space-y-2",children:p.data.expenses.slice(0,5).map(g=>{const N=W(g.category||"other"),w=N.icon;return e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${N.bgColor}`,children:e.jsx(w,{className:`h-4 w-4 ${N.color}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:g.description}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(g.createdAt).toLocaleDateString()})]})]}),e.jsxs("p",{className:"font-bold",children:["à§³",g.amount.toFixed(2)]})]},g.id)})})]})})]})},b=p=>e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Found ",p.length," ",p.length===1?"expense":"expenses",' matching "',a,'"']}),e.jsx("div",{className:"space-y-3",children:p.map(x=>{const u=W(x.category||"other"),g=u.icon;return e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl bg-gradient-to-r from-gray-50 to-white dark:from-gray-700 dark:to-gray-800 border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-3 rounded-xl ${u.bgColor}`,children:e.jsx(g,{className:`h-5 w-5 ${u.color}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:x.description}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(x.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-xl font-bold text-emerald-600 dark:text-emerald-400",children:["à§³",x.amount.toFixed(2)]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${u.bgColor} ${u.color}`,children:u.label})]})]},x.id)})})]});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs($,{className:"border-0 shadow-xl bg-gradient-to-r from-purple-500 to-pink-600 text-white overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"}),e.jsxs(T,{className:"p-6 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-white/20 backdrop-blur-sm",children:e.jsx(oe,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold",children:"AI Assistant"}),e.jsx("p",{className:"text-sm text-white/80",children:"Ask questions about your spending"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ws,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx(G,{type:"text",placeholder:"Ask: 'How much did I spend on food?' or 'Show coffee expenses'",value:a,onChange:p=>f(p.target.value),className:"pl-12 py-6 bg-white text-gray-900 border-0 shadow-lg placeholder:text-gray-500"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[e.jsx("span",{className:"text-xs text-white/60",children:"Try:"}),C.map((p,x)=>e.jsx("button",{onClick:()=>f(p),className:"text-xs px-3 py-1 rounded-full bg-white/20 hover:bg-white/30 transition-colors backdrop-blur-sm",children:p},x))]})]})]}),d&&e.jsx($,{className:"border-0 shadow-lg bg-white",children:e.jsx(T,{className:"p-6",children:t?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500 mb-4"}),e.jsx("p",{children:"Analyzing..."})]}):!n||n.type==="results"&&n.data?.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Is,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsxs("p",{className:"text-muted-foreground",children:['No results found for "',a,'"']}),e.jsx("p",{className:"text-sm text-muted-foreground/70 mt-1",children:"Try a different question"})]}):n.type==="analytics"?j(n):n.type==="results"?b(n.data):b(n)})})]})}var fe="Collapsible",[yt,as]=Ue(fe),[Nt,Fe]=yt(fe),rs=h.forwardRef((s,a)=>{const{__scopeCollapsible:c,open:n,defaultOpen:r,disabled:t,onOpenChange:l,...d}=s,[o,f]=Ae({prop:n,defaultProp:r??!1,onChange:l,caller:fe});return e.jsx(Nt,{scope:c,disabled:t,contentId:qe(),open:o,onOpenToggle:h.useCallback(()=>f(C=>!C),[f]),children:e.jsx(re.div,{"data-state":_e(o),"data-disabled":t?"":void 0,...d,ref:a})})});rs.displayName=fe;var ns="CollapsibleTrigger",ls=h.forwardRef((s,a)=>{const{__scopeCollapsible:c,...n}=s,r=Fe(ns,c);return e.jsx(re.button,{type:"button","aria-controls":r.contentId,"aria-expanded":r.open||!1,"data-state":_e(r.open),"data-disabled":r.disabled?"":void 0,disabled:r.disabled,...n,ref:a,onClick:Ye(s.onClick,r.onOpenToggle)})});ls.displayName=ns;var Ee="CollapsibleContent",os=h.forwardRef((s,a)=>{const{forceMount:c,...n}=s,r=Fe(Ee,s.__scopeCollapsible);return e.jsx(As,{present:c||r.open,children:({present:t})=>e.jsx(vt,{...n,ref:a,present:t})})});os.displayName=Ee;var vt=h.forwardRef((s,a)=>{const{__scopeCollapsible:c,present:n,children:r,...t}=s,l=Fe(Ee,c),[d,o]=h.useState(n),f=h.useRef(null),C=Ge(a,f),j=h.useRef(0),b=j.current,p=h.useRef(0),x=p.current,u=l.open||d,g=h.useRef(u),N=h.useRef(void 0);return h.useEffect(()=>{const w=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(w)},[]),ks(()=>{const w=f.current;if(w){N.current=N.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const A=w.getBoundingClientRect();j.current=A.height,p.current=A.width,g.current||(w.style.transitionDuration=N.current.transitionDuration,w.style.animationName=N.current.animationName),o(n)}},[l.open,n]),e.jsx(re.div,{"data-state":_e(l.open),"data-disabled":l.disabled?"":void 0,id:l.contentId,hidden:!u,...t,ref:C,style:{"--radix-collapsible-content-height":b?`${b}px`:void 0,"--radix-collapsible-content-width":x?`${x}px`:void 0,...s.style},children:u&&r})});function _e(s){return s?"open":"closed"}var wt=rs,Ct=ls,At=os,H="Accordion",kt=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[$e,St,Dt]=$s(H),[je]=Ue(H,[Dt,as]),Te=as(),is=O.forwardRef((s,a)=>{const{type:c,...n}=s,r=n,t=n;return e.jsx($e.Provider,{scope:s.__scopeAccordion,children:c==="multiple"?e.jsx(Rt,{...t,ref:a}):e.jsx(Mt,{...r,ref:a})})});is.displayName=H;var[cs,Pt]=je(H),[ds,It]=je(H,{collapsible:!1}),Mt=O.forwardRef((s,a)=>{const{value:c,defaultValue:n,onValueChange:r=()=>{},collapsible:t=!1,...l}=s,[d,o]=Ae({prop:c,defaultProp:n??"",onChange:r,caller:H});return e.jsx(cs,{scope:s.__scopeAccordion,value:O.useMemo(()=>d?[d]:[],[d]),onItemOpen:o,onItemClose:O.useCallback(()=>t&&o(""),[t,o]),children:e.jsx(ds,{scope:s.__scopeAccordion,collapsible:t,children:e.jsx(xs,{...l,ref:a})})})}),Rt=O.forwardRef((s,a)=>{const{value:c,defaultValue:n,onValueChange:r=()=>{},...t}=s,[l,d]=Ae({prop:c,defaultProp:n??[],onChange:r,caller:H}),o=O.useCallback(C=>d((j=[])=>[...j,C]),[d]),f=O.useCallback(C=>d((j=[])=>j.filter(b=>b!==C)),[d]);return e.jsx(cs,{scope:s.__scopeAccordion,value:l,onItemOpen:o,onItemClose:f,children:e.jsx(ds,{scope:s.__scopeAccordion,collapsible:!0,children:e.jsx(xs,{...t,ref:a})})})}),[Ft,be]=je(H),xs=O.forwardRef((s,a)=>{const{__scopeAccordion:c,disabled:n,dir:r,orientation:t="vertical",...l}=s,d=O.useRef(null),o=Ge(d,a),f=St(c),j=Ss(r)==="ltr",b=Ye(s.onKeyDown,p=>{if(!kt.includes(p.key))return;const x=p.target,u=f().filter(v=>!v.ref.current?.disabled),g=u.findIndex(v=>v.ref.current===x),N=u.length;if(g===-1)return;p.preventDefault();let w=g;const A=0,k=N-1,E=()=>{w=g+1,w>k&&(w=A)},_=()=>{w=g-1,w<A&&(w=k)};switch(p.key){case"Home":w=A;break;case"End":w=k;break;case"ArrowRight":t==="horizontal"&&(j?E():_());break;case"ArrowDown":t==="vertical"&&E();break;case"ArrowLeft":t==="horizontal"&&(j?_():E());break;case"ArrowUp":t==="vertical"&&_();break}const y=w%N;u[y].ref.current?.focus()});return e.jsx(Ft,{scope:c,disabled:n,direction:r,orientation:t,children:e.jsx($e.Slot,{scope:c,children:e.jsx(re.div,{...l,"data-orientation":t,ref:o,onKeyDown:n?void 0:b})})})}),pe="AccordionItem",[Et,Oe]=je(pe),ms=O.forwardRef((s,a)=>{const{__scopeAccordion:c,value:n,...r}=s,t=be(pe,c),l=Pt(pe,c),d=Te(c),o=qe(),f=n&&l.value.includes(n)||!1,C=t.disabled||s.disabled;return e.jsx(Et,{scope:c,open:f,disabled:C,triggerId:o,children:e.jsx(wt,{"data-orientation":t.orientation,"data-state":js(f),...d,...r,ref:a,disabled:C,open:f,onOpenChange:j=>{j?l.onItemOpen(n):l.onItemClose(n)}})})});ms.displayName=pe;var us="AccordionHeader",hs=O.forwardRef((s,a)=>{const{__scopeAccordion:c,...n}=s,r=be(H,c),t=Oe(us,c);return e.jsx(re.h3,{"data-orientation":r.orientation,"data-state":js(t.open),"data-disabled":t.disabled?"":void 0,...n,ref:a})});hs.displayName=us;var Ce="AccordionTrigger",ps=O.forwardRef((s,a)=>{const{__scopeAccordion:c,...n}=s,r=be(H,c),t=Oe(Ce,c),l=It(Ce,c),d=Te(c);return e.jsx($e.ItemSlot,{scope:c,children:e.jsx(Ct,{"aria-disabled":t.open&&!l.collapsible||void 0,"data-orientation":r.orientation,id:t.triggerId,...d,...n,ref:a})})});ps.displayName=Ce;var gs="AccordionContent",fs=O.forwardRef((s,a)=>{const{__scopeAccordion:c,...n}=s,r=be(H,c),t=Oe(gs,c),l=Te(c);return e.jsx(At,{role:"region","aria-labelledby":t.triggerId,"data-orientation":r.orientation,...l,...n,ref:a,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...s.style}})});fs.displayName=gs;function js(s){return s?"open":"closed"}var _t=is,$t=ms,Tt=hs,Ot=ps,Lt=fs;function Bt({...s}){return e.jsx(_t,{"data-slot":"accordion",...s})}function zt({className:s,...a}){return e.jsx($t,{"data-slot":"accordion-item",className:ge("border-b last:border-b-0",s),...a})}function Vt({className:s,children:a,...c}){return e.jsx(Tt,{className:"flex",children:e.jsxs(Ot,{"data-slot":"accordion-trigger",className:ge("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",s),...c,children:[a,e.jsx(Ts,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function Ht({className:s,children:a,...c}){return e.jsx(Lt,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...c,children:e.jsx("div",{className:ge("pt-0 pb-4",s),children:a})})}function Ut({expenses:s,budgets:a,trends:c,stats:n,onCreateExpense:r,onDeleteExpense:t,onCreateBudget:l,onDeleteBudget:d,onSearch:o,onScanReceipt:f,onGetAIInsights:C}){const[j,b]=h.useState(!1),[p,x]=h.useState(!1),[u,g]=h.useState(!1),[N,w]=h.useState("all"),A=Array.isArray(s)?s:[],k=new Date,E=k.getMonth(),_=k.getFullYear(),y=h.useMemo(()=>A.filter(S=>{const L=new Date(S.createdAt);return L.getMonth()===E&&L.getFullYear()===_}),[A,E,_]),v=h.useMemo(()=>y.reduce((S,L)=>S+(L.amount||0),0),[y]),K=h.useMemo(()=>A.reduce((S,L)=>S+(L.amount||0),0),[A]),ye=h.useMemo(()=>A.reduce((S,L)=>Math.max(S,L.amount||0),0),[A]),J=y.length>0?v/y.length:0,ne=h.useMemo(()=>N==="month"?y:N==="large"?A.filter(S=>(S.amount||0)>=5e3):N==="receipt"?A.filter(S=>!!(S.receiptUrl||S.attachmentUrl||S.receiptId)):A,[N,y,A]),Ne=[{id:"all",label:"All spend"},{id:"month",label:"This month"},{id:"large",label:"> à§³5K"},{id:"receipt",label:"With receipt"}],Q=S=>`à§³${Math.abs(S??0).toLocaleString("en-US",{maximumFractionDigits:0})}`,le=()=>{const S=Array.isArray(s)?s:[],L=["Date","Description","Amount","Category","Notes"],ve=S.map(M=>[new Date(M.createdAt).toLocaleDateString(),M.description,`à§³${M.amount.toFixed(2)}`,M.category,M.notes||""]),i=[L,...ve].map(M=>M.map(z=>`"${z}"`).join(",")).join(`
`),m=new Blob([i],{type:"text/csv"}),D=window.URL.createObjectURL(m),R=document.createElement("a");R.href=D,R.download=`personal-expenses-${new Date().toISOString().split("T")[0]}.csv`,R.click(),window.URL.revokeObjectURL(D)};return e.jsxs("div",{className:"max-w-7xl mx-auto space-y-12 pb-20",children:[e.jsxs("section",{className:"grid gap-8 lg:grid-cols-2 xl:grid-cols-[1.5fr_0.9fr] items-stretch",children:[e.jsxs("div",{className:"rounded-[32px] border border-gray-200 bg-white p-8 xl:p-10 shadow-sm flex flex-col justify-between",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-gray-500",children:"Expenses"}),e.jsx("h1",{className:"mt-4 text-4xl font-semibold text-gray-900",children:"Personal workspace"}),e.jsx("p",{className:"mt-3 text-gray-600 max-w-2xl",children:"Capture every slip, normalize FX, and keep budgets honest without losing the human context."}),e.jsxs("div",{className:"mt-8 grid gap-4 sm:grid-cols-3",children:[e.jsxs("div",{className:"rounded-2xl border border-gray-200 p-5",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"This month"}),e.jsx("p",{className:"mt-3 text-2xl font-semibold text-gray-900",children:Q(v)}),e.jsxs("p",{className:"text-sm text-gray-500",children:[y.length," entries"]})]}),e.jsxs("div",{className:"rounded-2xl border border-gray-200 p-5",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Lifetime personal"}),e.jsx("p",{className:"mt-3 text-2xl font-semibold text-gray-900",children:Q(K)}),e.jsx("p",{className:"text-sm text-gray-500",children:"Total captured spend"})]}),e.jsxs("div",{className:"rounded-2xl border border-gray-200 p-5",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Avg. ticket"}),e.jsx("p",{className:"mt-3 text-2xl font-semibold text-gray-900",children:Q(J)}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Largest ",Q(ye)]})]})]}),e.jsxs("div",{className:"mt-8 flex flex-wrap gap-3",children:[e.jsxs(I,{className:"bg-emerald-500 hover:bg-emerald-600 text-white rounded-full px-6",onClick:()=>b(!0),children:[e.jsx(Ke,{className:"h-4 w-4"}),"Log expense"]}),e.jsxs(I,{variant:"outline",className:"rounded-full px-4",onClick:()=>x(!0),children:[e.jsx(We,{className:"h-4 w-4"}),"Scan receipt"]}),e.jsxs(I,{variant:"ghost",className:"rounded-full px-4 text-gray-600 hover:text-gray-900",onClick:le,children:[e.jsx(Le,{className:"h-4 w-4"}),"Export CSV"]})]})]}),e.jsxs("div",{className:"rounded-[32px] border border-gray-200 bg-white p-8 xl:p-10 shadow-sm",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.5em] text-gray-500",children:"Budget guardrails"}),e.jsx("h2",{className:"text-3xl font-semibold text-gray-900",children:"Keep envelopes honest"}),e.jsx("p",{className:"text-gray-600",children:"Set envelopes, watch utilization, and adjust spend categories without leaving your personal view."})]}),e.jsx("div",{className:"mt-6 rounded-3xl border border-gray-200 bg-gray-50 p-4 xl:p-6 shadow-inner",children:e.jsx(Bt,{type:"multiple",defaultValue:["budgets"],children:e.jsxs(zt,{value:"budgets",children:[e.jsx(Vt,{className:"text-base font-medium text-gray-900",children:"Budget guardrails"}),e.jsx(Ht,{className:"pt-2",children:e.jsx(pt,{budgets:a,expenses:s,onCreateBudget:l,onDeleteBudget:d})})]})})})]})]}),e.jsxs("section",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-3xl border border-gray-200 bg-white p-6 xl:p-8 shadow-sm space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-end sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-500",children:"Expense ledger"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Detailed timeline"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Showing ",ne.length," of ",A.length," entries"]})]}),e.jsxs(I,{variant:"outline",className:"rounded-full",onClick:le,children:[e.jsx(Le,{className:"h-4 w-4"}),"Export"]})]}),e.jsx("div",{className:"rounded-2xl border border-dashed border-gray-200 bg-gray-50 p-4",children:e.jsx(bt,{onSearch:o})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Ne.map(S=>e.jsx("button",{onClick:()=>w(S.id),className:`rounded-full border px-4 py-1 text-sm transition ${N===S.id?"border-gray-900 bg-gray-900 text-white":"border-gray-200 bg-white text-gray-600 hover:border-gray-400"}`,children:S.label},S.id))}),e.jsx(gt,{expenses:ne,onDelete:t})]}),e.jsxs("div",{className:"rounded-3xl border border-gray-200 bg-white p-6 xl:p-8 shadow-sm",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-500",children:"Monthly pulse"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Budgets vs actual"})]}),e.jsx(ht,{expenses:s,budgets:a,stats:n})]})]}),e.jsx(ft,{open:j,onOpenChange:b,onCreate:r}),e.jsx(jt,{open:p,onOpenChange:x,onScan:f,onCreate:r})]})}function ta(s){return s.loading?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Loading..."}):e.jsx(Ut,{...s})}export{ta as ExpensesPage};
