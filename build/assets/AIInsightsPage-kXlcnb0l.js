import{c as F,r as i,j as e,S as I,B as m,ag as A,ah as $,C as c,a as d,M as z}from"./index-DwQK3muS.js";import{R as B}from"./refresh-cw-DjeXkFMi.js";import{C as U}from"./calendar-CHSlFlq8.js";import{D as P}from"./dollar-sign-DGDz-2Nv.js";import{T as q}from"./target-P-yb90kb.js";import{T as H}from"./trending-up-CoufMA-n.js";import{C as W,b as T,S as E,a as O,U as Q}from"./utensils-Drbt0Jsj.js";import{T as V}from"./triangle-alert-DfmRzlFQ.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],G=F("settings",K);function re({onGetAIInsights:D}){const[a,u]=i.useState(null),[h,N]=i.useState(!1),[o,L]=i.useState(0),[g,R]=i.useState(0),[p,v]=i.useState("month");i.useEffect(()=>{const s=setInterval(()=>{if(o>0){const t=Date.now()-o,l=Math.max(0,Math.ceil((15e3-t)/1e3));R(l)}},1e3);return()=>clearInterval(s)},[o]);const w=async()=>{const s=Date.now();if(!(h||s-o<15e3)){N(!0),L(s);try{const t=await D();if(!t){console.warn("AI insights returned null/undefined"),u({insights:[],summary:"Unable to load AI insights at this time.",recommendations:[],patterns:[],predictions:null,stats:{thisMonth:0,lastMonth:0,change:0,changePercentage:0}});return}t.error&&console.warn("AI insights returned with error:",t.error),u(t)}catch(t){console.error("Failed to fetch insights:",t.message||t);let l="AI insights are temporarily unavailable.",b="Please try again in a few minutes.";t.message.includes("Rate limit")||t.message.includes("Too Many Requests")?(l="⏱️ AI rate limit reached",b="OpenRouter free tier: 3 AI calls per minute with 15s cooldown. Results are cached for 4 hours. Please wait before refreshing."):t.message.includes("cooldown")&&(l="⏱️ Cooldown active",b=t.message),u({insights:[{type:"info",severity:"warning",message:l,value:0}],summary:b,recommendations:[{priority:"low",action:"Cached AI insights are served to minimize API usage. The cache refreshes every 4 hours automatically.",potential_savings:0}],patterns:[],predictions:null,stats:{thisMonth:0,lastMonth:0,change:0,changePercentage:0}})}finally{N(!1)}}};i.useEffect(()=>{w()},[]);const _=s=>({food:Q,transport:O,rent:z,shopping:E,entertainment:T})[s?.toLowerCase()]||P,x=a?.stats?a.stats.thisMonth<a.stats.lastMonth?"under":"over":"under",r=a?.stats??{thisMonth:0,lastMonth:0,changePercentage:0},n=s=>`৳${(s??0).toLocaleString("en-US",{maximumFractionDigits:0})}`,j=s=>`${Math.abs(s??0).toFixed(0)}%`,k=[{label:p==="month"?"This month burn":"Quarter burn",value:n(r.thisMonth),detail:p==="month"?"vs last month":"vs previous quarter",delta:j(r.changePercentage),positive:(r.changePercentage??0)<=0},{label:"Last horizon",value:n(r.lastMonth),detail:"Previous period spend",delta:x==="under"?"Stable":"Climbing",positive:x==="under"},{label:"Delta tracked",value:n(Math.abs(r.thisMonth-r.lastMonth)),detail:"Movement detected",delta:j(r.changePercentage),positive:r.thisMonth<=r.lastMonth}],M=a?.insights??[],C=(a?.recommendations??[]).slice(0,3),f=(a?.patterns??[]).slice(0,4),S=a?.summary??"AI is warming up your latest ledger activity.",y=a?.predictions;return e.jsxs("div",{className:"max-w-7xl mx-auto space-y-10 pb-16",children:[e.jsx("section",{className:"rounded-[36px] bg-gradient-to-br from-gray-900 via-indigo-950 to-emerald-950 p-10 text-white",children:e.jsxs("div",{className:"flex flex-col gap-10 lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-white/20 px-4 py-1 text-xs uppercase tracking-[0.5em] text-white/60",children:[e.jsx(I,{className:"h-4 w-4"}),"Signal Deck"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl lg:text-5xl font-semibold leading-tight",children:"AI command center"}),e.jsx("p",{className:"mt-4 max-w-2xl text-white/70",children:S})]}),e.jsx("div",{className:"flex flex-wrap gap-2 rounded-full bg-white/10 p-1",children:["month","quarter"].map(s=>e.jsx("button",{onClick:()=>v(s),className:`rounded-full px-5 py-2 text-sm transition ${p===s?"bg-white text-gray-900":"text-white/70 hover:bg-white/10"}`,children:s==="month"?"This Month":"Last Quarter"},s))}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs(m,{variant:"secondary",className:"rounded-full bg-white text-gray-900 hover:bg-white/90",onClick:w,disabled:h||g>0,children:[e.jsx(B,{className:`mr-2 h-4 w-4 ${h?"animate-spin":""}`}),"Refresh insights"]}),e.jsxs(m,{variant:"outline",className:"rounded-full border-white/30 text-white hover:bg-white/10",onClick:()=>v(p==="month"?"quarter":"month"),children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Toggle horizon"]}),g>0&&e.jsxs("span",{className:"rounded-full border border-white/20 px-4 py-2 text-xs text-white/60",children:["Cooldown ",g,"s"]})]})]}),e.jsx("div",{className:"grid w-full max-w-md gap-4",children:k.map(s=>e.jsxs(A.div,{whileHover:{y:-4},className:"rounded-3xl border border-white/15 bg-white/5 p-6 shadow-inner",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-white/60",children:s.label}),e.jsx("p",{className:"mt-3 text-3xl font-semibold",children:s.value}),e.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm text-white/70",children:[e.jsx("span",{children:s.detail}),e.jsx("span",{className:s.positive?"text-emerald-300":"text-rose-300",children:s.delta})]})]},s.label))})]})}),e.jsx("div",{className:"rounded-3xl border border-blue-200/60 bg-blue-50/70 p-5 text-sm text-blue-900",children:e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($,{className:"h-5 w-5 text-blue-600"}),e.jsxs("p",{children:["Smart caching keeps responses fresh for 4 hours. A ",g||15,"-second cooldown protects the model."]})]}),e.jsxs("p",{className:"text-xs text-blue-700",children:["Last sync • ",new Date(o||Date.now()).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})}),h?e.jsxs("div",{className:"rounded-3xl border border-gray-200 bg-white py-20 text-center shadow-sm",children:[e.jsx("div",{className:"mx-auto mb-6 inline-flex h-16 w-16 items-center justify-center rounded-full bg-emerald-100",children:e.jsx(I,{className:"h-8 w-8 text-emerald-600 animate-pulse"})}),e.jsx("p",{className:"text-gray-600",children:"Analyzing your spending patterns..."})]}):a?e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"grid gap-6 lg:grid-cols-[1.1fr_0.9fr]",children:[e.jsx(c,{className:"rounded-3xl border border-gray-200 shadow-lg",children:e.jsxs(d,{className:"space-y-6 p-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Budget radar"}),e.jsx("h2",{className:"text-3xl font-semibold text-gray-900",children:x==="under"?"Under budget":"Over budget"})]}),e.jsx("div",{className:`rounded-full px-4 py-2 text-sm ${x==="under"?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:x==="under"?"Healthy":"Watchlist"})]}),e.jsx("p",{className:"text-gray-500 text-sm leading-relaxed",children:S}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-3",children:k.map(s=>e.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:s.label}),e.jsx("p",{className:"mt-3 text-2xl font-semibold text-gray-900",children:s.value}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s.detail})]},s.label))}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(m,{className:"rounded-full bg-emerald-500 text-white hover:bg-emerald-600",children:"Open detailed report"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Last change ",j(r.changePercentage)]})]})]})}),e.jsx(c,{className:"rounded-3xl border border-gray-200",children:e.jsxs(d,{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Signal stack"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Live monitors"})]}),e.jsx(G,{className:"h-5 w-5 text-gray-400"})]}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:f.length>0?f.map((s,t)=>{const l=_(s.category);return e.jsxs(A.div,{whileHover:{scale:1.01},className:"rounded-2xl border border-gray-100 bg-gray-50/70 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-2xl bg-white p-2 shadow-sm",children:e.jsx(l,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:s.category||"Spend"}),e.jsx("p",{className:"text-xs text-gray-500",children:s.trend||"Stable"})]})]}),e.jsx("p",{className:"mt-3 text-sm text-gray-600",children:s.description||"AI detected consistent behavior."})]},`${s.category}-${t}`)}):e.jsx("p",{className:"text-sm text-gray-500",children:"Pattern data will show up after a few more syncs."})})]})})]}),e.jsxs("section",{className:"grid gap-6 lg:grid-cols-[1fr_0.8fr]",children:[e.jsx(c,{className:"rounded-3xl border border-gray-200",children:e.jsxs(d,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Where money flows"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Category pulse"})]}),e.jsx(P,{className:"h-5 w-5 text-gray-400"})]}),e.jsxs("div",{className:"flex flex-col gap-6 md:flex-row md:items-center",children:[e.jsxs("div",{className:"relative mx-auto h-48 w-48",children:[e.jsxs("svg",{className:"h-full w-full",viewBox:"0 0 100 100",children:[e.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#10b981",strokeWidth:"12",strokeDasharray:"140 251",transform:"rotate(-90 50 50)"}),e.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#3b82f6",strokeWidth:"12",strokeDasharray:"70 251",strokeDashoffset:"-140",transform:"rotate(-90 50 50)"}),e.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"#f97316",strokeWidth:"12",strokeDasharray:"41 251",strokeDashoffset:"-210",transform:"rotate(-90 50 50)"})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-center",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Tracked"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:n(r.thisMonth)}),e.jsx("p",{className:"text-xs text-gray-500",children:"This period"})]})]}),e.jsx("div",{className:"flex-1 space-y-4",children:f.slice(0,3).map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-gray-100 bg-gray-50 p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`h-3 w-3 rounded-full ${["bg-emerald-500","bg-blue-500","bg-orange-500"][t%3]}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.category||"Spending"}),e.jsx("p",{className:"text-xs text-gray-500",children:s.trend||"Neutral"})]})]}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:s.value||s.amount||"—"})]},`legend-${t}`))})]})]})}),e.jsx(c,{className:"rounded-3xl border border-gray-200",children:e.jsxs(d,{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Projection lab"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Financial projector"})]}),e.jsx(q,{className:"h-5 w-5 text-gray-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Monthly savings dial"}),e.jsx("div",{className:"mt-2 flex gap-3",children:[50,100,200].map(s=>e.jsxs("button",{className:"rounded-2xl border border-gray-200 px-4 py-2 text-sm text-gray-600 hover:border-emerald-400",children:["৳",s]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Custom addition"}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"৳"}),e.jsx("input",{className:"w-full rounded-2xl border border-gray-200 py-2 pl-8 pr-4 focus:border-emerald-500 focus:outline-none",placeholder:"75",type:"number"}),e.jsx(H,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-emerald-500"})]})]}),y?e.jsxs("div",{className:"rounded-2xl border border-emerald-100 bg-emerald-50 p-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-emerald-600",children:"Projected total"}),e.jsx("p",{className:"mt-2 text-3xl font-semibold text-emerald-700",children:n(y.month_end_total)}),e.jsxs("p",{className:"text-xs text-emerald-600",children:["Confidence ",y.confidence]})]}):e.jsx("p",{className:"rounded-2xl border border-dashed border-gray-200 p-4 text-sm text-gray-500",children:"Projection appears after at least two periods of data."}),e.jsx(m,{className:"w-full rounded-full bg-gray-900 text-white hover:bg-gray-800",children:"Save new goal"})]})})]}),e.jsxs("section",{className:"grid gap-6 lg:grid-cols-[1.1fr_0.9fr]",children:[e.jsx(c,{className:"rounded-3xl border border-gray-200",children:e.jsxs(d,{className:"space-y-5 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Action lab"}),e.jsx(W,{className:"h-5 w-5 text-gray-400"})]}),a.error&&e.jsxs("div",{className:"rounded-2xl border border-yellow-200 bg-yellow-50 p-4 text-sm text-yellow-800",children:[e.jsx(V,{className:"mr-2 inline h-4 w-4"}),a.error]}),M.length>0?e.jsx("div",{className:"space-y-3",children:M.slice(0,4).map((s,t)=>e.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-4",children:[e.jsx("p",{className:"text-sm text-gray-700",children:s.message||"Insight available soon."}),s.value&&e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Signal value: ",s.value]})]},t))}):e.jsx("p",{className:"text-sm text-gray-500",children:"No critical callouts yet. Keep feeding data."})]})}),e.jsx(c,{className:"rounded-3xl border border-gray-200",children:e.jsxs(d,{className:"space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Recommendation board"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Do next"})]}),C.length>0?e.jsx("div",{className:"space-y-4",children:C.map((s,t)=>e.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-white p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(T,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.action||"Review subscription stack"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Priority: ",s.priority||"medium"]})]})]}),s.potential_savings&&e.jsxs("p",{className:"mt-3 text-sm text-gray-600",children:["Potential save ",n(s.potential_savings)]}),e.jsx(m,{variant:"outline",className:"mt-4 w-full rounded-full",children:"Launch playbook"})]},t))}):e.jsx("p",{className:"text-sm text-gray-500",children:"AI will surface plays after crunching a few more receipts."})]})})]})]}):null]})}export{re as AIInsightsPage};
