import{c as oe,j as e,U as pe,C as Q,a as U,R as ie,r as o,B as F,q as Xe,I as J,s as Tt,u as at,P as _t,v as se,w as rt,x as ae,y as ee,z as nt,g as me,D as lt,E as $t,F as it,X as It,L as G,T as ot,G as zt,H as Ot,J as Ie,l as ne,m as le,e as Lt}from"./index-DwQK3muS.js";import{D as ye,i as ve,a as Ne,b as Pe,c as we,d as ke,u as dt,j as qt,S as ge,e as fe,f as be,g as je,h as q,k as Vt}from"./select-B6NQ53IA.js";import{P as Oe,C as Je,T as Ge,A as Kt,a as Ht,b as Gt,c as Yt,d as Wt,e as Xt,f as Jt,g as Qt,h as Ut}from"./textarea-D09Hp-LN.js";import{e as Zt,C as es,D as ts,g as Qe}from"./ExpenseCategories-CMdOrydD.js";import{C as ss}from"./utensils-Drbt0Jsj.js";import{D as ct}from"./dollar-sign-DGDz-2Nv.js";import{T as as}from"./trending-up-CoufMA-n.js";import{T as rs}from"./triangle-alert-DfmRzlFQ.js";import{C as ns}from"./clock-B0-LGOy4.js";import{A as ls}from"./AddFriendDialog-CMPfcJIx.js";import"./tabs-DTQ2Clpe.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],Le=oe("banknote",is);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],Ue=oe("calculator",os);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],qe=oe("calendar-days",ds);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ms=oe("circle-check-big",cs);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Ze=oe("crown",xs);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],mt=oe("percent",hs);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]],xt=oe("scale",us);function ps({groups:s,onSelectGroup:n}){return s.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-flex p-8 rounded-full bg-gradient-to-br from-emerald-100 to-teal-200 dark:from-emerald-900 dark:to-teal-800 mb-6 shadow-lg",children:e.jsx(pe,{className:"h-16 w-16 text-emerald-600 dark:text-emerald-400"})}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No groups yet"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Create your first group to start splitting expenses!"}),e.jsxs("div",{className:"max-w-md mx-auto bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 rounded-2xl p-6 shadow-xl border border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-semibold mb-3 text-emerald-600 dark:text-emerald-400",children:"Getting Started"}),e.jsxs("div",{className:"text-left space-y-3 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-emerald-500 text-white flex items-center justify-center text-xs",children:"1"}),e.jsx("p",{children:'Click "Add Friend" to add friends to your network'})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-teal-500 text-white flex items-center justify-center text-xs",children:"2"}),e.jsx("p",{children:'Click "Create Group" to start a new expense group'})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-blue-500 text-white flex items-center justify-center text-xs",children:"3"}),e.jsx("p",{children:"Add members and start tracking shared expenses!"})]})]})]})]}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:s.map((l,i)=>e.jsxs(Q,{className:"cursor-pointer card-hover border-0 shadow-xl bg-white overflow-hidden relative group",onClick:()=>n(l.id),children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-emerald-500/10 to-teal-500/10 rounded-full -mr-16 -mt-16 group-hover:scale-150 transition-transform duration-500"}),e.jsxs(U,{className:"p-6 relative z-10",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsx("div",{className:`p-3 rounded-2xl bg-gradient-to-br ${i%3===0?"from-emerald-500 to-teal-600":i%3===1?"from-blue-500 to-indigo-600":"from-purple-500 to-pink-600"} shadow-lg`,children:e.jsx(pe,{className:"h-6 w-6 text-white"})})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:l.name}),l.description&&e.jsx("p",{className:"text-muted-foreground text-sm mb-4 line-clamp-2",children:l.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-emerald-100 dark:bg-emerald-900/30",children:e.jsx(pe,{className:"h-4 w-4 text-emerald-600 dark:text-emerald-400"})}),e.jsx("span",{className:"font-medium",children:l.memberCount})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-blue-100 dark:bg-blue-900/30",children:e.jsx(ie,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),e.jsx("span",{className:"font-medium",children:l.expenseCount})]})]})]})]},l.id))})}function gs({friends:s,existingMemberIds:n,onAddMember:l}){const[i,c]=o.useState(!1),[d,x]=o.useState(!1),[p,f]=o.useState(""),w=s.filter(g=>!n.includes(g.id)),v=w.filter(g=>g.name.toLowerCase().includes(p.toLowerCase())||g.username.toLowerCase().includes(p.toLowerCase())||g.email.toLowerCase().includes(p.toLowerCase())),h=async g=>{x(!0);try{await l(g)}catch(j){console.error("Failed to add member:",j)}finally{x(!1)}};return e.jsxs(ye,{open:i,onOpenChange:c,children:[e.jsx(ve,{asChild:!0,children:e.jsxs(F,{variant:"outline",size:"sm",className:"bg-gradient-to-r from-emerald-500 to-teal-600 text-white hover:from-emerald-600 hover:to-teal-700 border-0",children:[e.jsx(Xe,{className:"h-4 w-4 mr-2"}),"Add Friend"]})}),e.jsxs(Ne,{className:"sm:max-w-md",children:[e.jsxs(Pe,{children:[e.jsx(we,{children:"Add Friend to Group"}),e.jsx(ke,{children:"Select a friend from your list to add them to this group."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(J,{placeholder:"Search friends...",value:p,onChange:g=>f(g.target.value)}),v.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:w.length===0?"All your friends are already in this group!":"No friends found matching your search"})}):e.jsx(Tt,{className:"h-[300px] pr-4",children:e.jsx("div",{className:"space-y-2",children:v.map(g=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:g.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",g.username]})]}),e.jsxs(F,{size:"sm",onClick:()=>h(g.id),disabled:d,className:"bg-gradient-to-r from-emerald-500 to-teal-600 text-white hover:from-emerald-600 hover:to-teal-700",children:[e.jsx(Xe,{className:"h-4 w-4 mr-1"}),"Add"]})]},g.id))})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(F,{variant:"outline",onClick:()=>c(!1),children:"Done"})})]})]})]})}var Ee="Checkbox",[fs]=at(Ee),[bs,Ye]=fs(Ee);function js(s){const{__scopeCheckbox:n,checked:l,children:i,defaultChecked:c,disabled:d,form:x,name:p,onCheckedChange:f,required:w,value:v="on",internal_do_not_use_render:h}=s,[g,j]=rt({prop:l,defaultProp:c??!1,onChange:f,caller:Ee}),[N,S]=o.useState(null),[D,y]=o.useState(null),E=o.useRef(!1),M=N?!!x||!!N.closest("form"):!0,C={checked:g,disabled:d,setChecked:j,control:N,setControl:S,name:p,form:x,value:v,hasConsumerStoppedPropagationRef:E,required:w,defaultChecked:te(c)?!1:c,isFormControl:M,bubbleInput:D,setBubbleInput:y};return e.jsx(bs,{scope:n,...C,children:ys(h)?h(C):i})}var ht="CheckboxTrigger",ut=o.forwardRef(({__scopeCheckbox:s,onKeyDown:n,onClick:l,...i},c)=>{const{control:d,value:x,disabled:p,checked:f,required:w,setControl:v,setChecked:h,hasConsumerStoppedPropagationRef:g,isFormControl:j,bubbleInput:N}=Ye(ht,s),S=ae(c,v),D=o.useRef(f);return o.useEffect(()=>{const y=d?.form;if(y){const E=()=>h(D.current);return y.addEventListener("reset",E),()=>y.removeEventListener("reset",E)}},[d,h]),e.jsx(se.button,{type:"button",role:"checkbox","aria-checked":te(f)?"mixed":f,"aria-required":w,"data-state":yt(f),"data-disabled":p?"":void 0,disabled:p,value:x,...i,ref:S,onKeyDown:ee(n,y=>{y.key==="Enter"&&y.preventDefault()}),onClick:ee(l,y=>{h(E=>te(E)?!0:!E),N&&j&&(g.current=y.isPropagationStopped(),g.current||y.stopPropagation())})})});ut.displayName=ht;var pt=o.forwardRef((s,n)=>{const{__scopeCheckbox:l,name:i,checked:c,defaultChecked:d,required:x,disabled:p,value:f,onCheckedChange:w,form:v,...h}=s;return e.jsx(js,{__scopeCheckbox:l,checked:c,defaultChecked:d,disabled:p,required:x,onCheckedChange:w,name:i,form:v,value:f,internal_do_not_use_render:({isFormControl:g})=>e.jsxs(e.Fragment,{children:[e.jsx(ut,{...h,ref:n,__scopeCheckbox:l}),g&&e.jsx(jt,{__scopeCheckbox:l})]})})});pt.displayName=Ee;var gt="CheckboxIndicator",ft=o.forwardRef((s,n)=>{const{__scopeCheckbox:l,forceMount:i,...c}=s,d=Ye(gt,l);return e.jsx(_t,{present:i||te(d.checked)||d.checked===!0,children:e.jsx(se.span,{"data-state":yt(d.checked),"data-disabled":d.disabled?"":void 0,...c,ref:n,style:{pointerEvents:"none",...s.style}})})});ft.displayName=gt;var bt="CheckboxBubbleInput",jt=o.forwardRef(({__scopeCheckbox:s,...n},l)=>{const{control:i,hasConsumerStoppedPropagationRef:c,checked:d,defaultChecked:x,required:p,disabled:f,name:w,value:v,form:h,bubbleInput:g,setBubbleInput:j}=Ye(bt,s),N=ae(l,j),S=dt(d),D=nt(i);o.useEffect(()=>{const E=g;if(!E)return;const M=window.HTMLInputElement.prototype,I=Object.getOwnPropertyDescriptor(M,"checked").set,T=!c.current;if(S!==d&&I){const R=new Event("click",{bubbles:T});E.indeterminate=te(d),I.call(E,te(d)?!1:d),E.dispatchEvent(R)}},[g,S,d,c]);const y=o.useRef(te(d)?!1:d);return e.jsx(se.input,{type:"checkbox","aria-hidden":!0,defaultChecked:x??y.current,required:p,disabled:f,name:w,value:v,form:h,...n,tabIndex:-1,ref:N,style:{...n.style,...D,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});jt.displayName=bt;function ys(s){return typeof s=="function"}function te(s){return s==="indeterminate"}function yt(s){return te(s)?"indeterminate":s?"checked":"unchecked"}function vs({className:s,...n}){return e.jsx(pt,{"data-slot":"checkbox",className:me("peer border bg-input-background dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...n,children:e.jsx(ft,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(lt,{className:"size-3.5"})})})}var vt=["PageUp","PageDown"],Nt=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],wt={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},xe="Slider",[Ve,Ns,ws]=qt(xe),[kt]=at(xe,[ws]),[ks,Me]=kt(xe),St=o.forwardRef((s,n)=>{const{name:l,min:i=0,max:c=100,step:d=1,orientation:x="horizontal",disabled:p=!1,minStepsBetweenThumbs:f=0,defaultValue:w=[i],value:v,onValueChange:h=()=>{},onValueCommit:g=()=>{},inverted:j=!1,form:N,...S}=s,D=o.useRef(new Set),y=o.useRef(0),M=x==="horizontal"?Ss:Cs,[C=[],I]=rt({prop:v,defaultProp:w,onChange:B=>{[...D.current][y.current]?.focus(),h(B)}}),T=o.useRef(C);function R(B){const W=Ms(C,B);P(B,W)}function Y(B){P(B,y.current)}function z(){const B=T.current[y.current];C[y.current]!==B&&g(C)}function P(B,W,{commit:X}={commit:!1}){const Z=Ts(d),K=_s(Math.round((B-i)/d)*d+i,Z),H=it(K,[i,c]);I(($=[])=>{const O=Ps($,H,W);if(Rs(O,f*d)){y.current=O.indexOf(H);const _=String(O)!==String($);return _&&X&&g(O),_?O:$}else return $})}return e.jsx(ks,{scope:s.__scopeSlider,name:l,disabled:p,min:i,max:c,valueIndexToChangeRef:y,thumbs:D.current,values:C,orientation:x,form:N,children:e.jsx(Ve.Provider,{scope:s.__scopeSlider,children:e.jsx(Ve.Slot,{scope:s.__scopeSlider,children:e.jsx(M,{"aria-disabled":p,"data-disabled":p?"":void 0,...S,ref:n,onPointerDown:ee(S.onPointerDown,()=>{p||(T.current=C)}),min:i,max:c,inverted:j,onSlideStart:p?void 0:R,onSlideMove:p?void 0:Y,onSlideEnd:p?void 0:z,onHomeKeyDown:()=>!p&&P(i,0,{commit:!0}),onEndKeyDown:()=>!p&&P(c,C.length-1,{commit:!0}),onStepKeyDown:({event:B,direction:W})=>{if(!p){const K=vt.includes(B.key)||B.shiftKey&&Nt.includes(B.key)?10:1,H=y.current,$=C[H],O=d*K*W;P($+O,H,{commit:!0})}}})})})})});St.displayName=xe;var[Ct,At]=kt(xe,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Ss=o.forwardRef((s,n)=>{const{min:l,max:i,dir:c,inverted:d,onSlideStart:x,onSlideMove:p,onSlideEnd:f,onStepKeyDown:w,...v}=s,[h,g]=o.useState(null),j=ae(n,M=>g(M)),N=o.useRef(void 0),S=$t(c),D=S==="ltr",y=D&&!d||!D&&d;function E(M){const C=N.current||h.getBoundingClientRect(),I=[0,C.width],R=We(I,y?[l,i]:[i,l]);return N.current=C,R(M-C.left)}return e.jsx(Ct,{scope:s.__scopeSlider,startEdge:y?"left":"right",endEdge:y?"right":"left",direction:y?1:-1,size:"width",children:e.jsx(Dt,{dir:S,"data-orientation":"horizontal",...v,ref:j,style:{...v.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:M=>{const C=E(M.clientX);x?.(C)},onSlideMove:M=>{const C=E(M.clientX);p?.(C)},onSlideEnd:()=>{N.current=void 0,f?.()},onStepKeyDown:M=>{const I=wt[y?"from-left":"from-right"].includes(M.key);w?.({event:M,direction:I?-1:1})}})})}),Cs=o.forwardRef((s,n)=>{const{min:l,max:i,inverted:c,onSlideStart:d,onSlideMove:x,onSlideEnd:p,onStepKeyDown:f,...w}=s,v=o.useRef(null),h=ae(n,v),g=o.useRef(void 0),j=!c;function N(S){const D=g.current||v.current.getBoundingClientRect(),y=[0,D.height],M=We(y,j?[i,l]:[l,i]);return g.current=D,M(S-D.top)}return e.jsx(Ct,{scope:s.__scopeSlider,startEdge:j?"bottom":"top",endEdge:j?"top":"bottom",size:"height",direction:j?1:-1,children:e.jsx(Dt,{"data-orientation":"vertical",...w,ref:h,style:{...w.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:S=>{const D=N(S.clientY);d?.(D)},onSlideMove:S=>{const D=N(S.clientY);x?.(D)},onSlideEnd:()=>{g.current=void 0,p?.()},onStepKeyDown:S=>{const y=wt[j?"from-bottom":"from-top"].includes(S.key);f?.({event:S,direction:y?-1:1})}})})}),Dt=o.forwardRef((s,n)=>{const{__scopeSlider:l,onSlideStart:i,onSlideMove:c,onSlideEnd:d,onHomeKeyDown:x,onEndKeyDown:p,onStepKeyDown:f,...w}=s,v=Me(xe,l);return e.jsx(se.span,{...w,ref:n,onKeyDown:ee(s.onKeyDown,h=>{h.key==="Home"?(x(h),h.preventDefault()):h.key==="End"?(p(h),h.preventDefault()):vt.concat(Nt).includes(h.key)&&(f(h),h.preventDefault())}),onPointerDown:ee(s.onPointerDown,h=>{const g=h.target;g.setPointerCapture(h.pointerId),h.preventDefault(),v.thumbs.has(g)?g.focus():i(h)}),onPointerMove:ee(s.onPointerMove,h=>{h.target.hasPointerCapture(h.pointerId)&&c(h)}),onPointerUp:ee(s.onPointerUp,h=>{const g=h.target;g.hasPointerCapture(h.pointerId)&&(g.releasePointerCapture(h.pointerId),d(h))})})}),Pt="SliderTrack",Et=o.forwardRef((s,n)=>{const{__scopeSlider:l,...i}=s,c=Me(Pt,l);return e.jsx(se.span,{"data-disabled":c.disabled?"":void 0,"data-orientation":c.orientation,...i,ref:n})});Et.displayName=Pt;var Ke="SliderRange",Mt=o.forwardRef((s,n)=>{const{__scopeSlider:l,...i}=s,c=Me(Ke,l),d=At(Ke,l),x=o.useRef(null),p=ae(n,x),f=c.values.length,w=c.values.map(g=>Rt(g,c.min,c.max)),v=f>1?Math.min(...w):0,h=100-Math.max(...w);return e.jsx(se.span,{"data-orientation":c.orientation,"data-disabled":c.disabled?"":void 0,...i,ref:p,style:{...s.style,[d.startEdge]:v+"%",[d.endEdge]:h+"%"}})});Mt.displayName=Ke;var He="SliderThumb",Bt=o.forwardRef((s,n)=>{const l=Ns(s.__scopeSlider),[i,c]=o.useState(null),d=ae(n,p=>c(p)),x=o.useMemo(()=>i?l().findIndex(p=>p.ref.current===i):-1,[l,i]);return e.jsx(As,{...s,ref:d,index:x})}),As=o.forwardRef((s,n)=>{const{__scopeSlider:l,index:i,name:c,...d}=s,x=Me(He,l),p=At(He,l),[f,w]=o.useState(null),v=ae(n,E=>w(E)),h=f?x.form||!!f.closest("form"):!0,g=nt(f),j=x.values[i],N=j===void 0?0:Rt(j,x.min,x.max),S=Es(i,x.values.length),D=g?.[p.size],y=D?Bs(D,N,p.direction):0;return o.useEffect(()=>{if(f)return x.thumbs.add(f),()=>{x.thumbs.delete(f)}},[f,x.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[p.startEdge]:`calc(${N}% + ${y}px)`},children:[e.jsx(Ve.ItemSlot,{scope:s.__scopeSlider,children:e.jsx(se.span,{role:"slider","aria-label":s["aria-label"]||S,"aria-valuemin":x.min,"aria-valuenow":j,"aria-valuemax":x.max,"aria-orientation":x.orientation,"data-orientation":x.orientation,"data-disabled":x.disabled?"":void 0,tabIndex:x.disabled?void 0:0,...d,ref:v,style:j===void 0?{display:"none"}:s.style,onFocus:ee(s.onFocus,()=>{x.valueIndexToChangeRef.current=i})})}),h&&e.jsx(Ft,{name:c??(x.name?x.name+(x.values.length>1?"[]":""):void 0),form:x.form,value:j},i)]})});Bt.displayName=He;var Ds="RadioBubbleInput",Ft=o.forwardRef(({__scopeSlider:s,value:n,...l},i)=>{const c=o.useRef(null),d=ae(c,i),x=dt(n);return o.useEffect(()=>{const p=c.current;if(!p)return;const f=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(f,"value").set;if(x!==n&&v){const h=new Event("input",{bubbles:!0});v.call(p,n),p.dispatchEvent(h)}},[x,n]),e.jsx(se.input,{style:{display:"none"},...l,ref:d,defaultValue:n})});Ft.displayName=Ds;function Ps(s=[],n,l){const i=[...s];return i[l]=n,i.sort((c,d)=>c-d)}function Rt(s,n,l){const d=100/(l-n)*(s-n);return it(d,[0,100])}function Es(s,n){return n>2?`Value ${s+1} of ${n}`:n===2?["Minimum","Maximum"][s]:void 0}function Ms(s,n){if(s.length===1)return 0;const l=s.map(c=>Math.abs(c-n)),i=Math.min(...l);return l.indexOf(i)}function Bs(s,n,l){const i=s/2,d=We([0,50],[0,i]);return(i-d(n)*l)*l}function Fs(s){return s.slice(0,-1).map((n,l)=>s[l+1]-n)}function Rs(s,n){if(n>0){const l=Fs(s);return Math.min(...l)>=n}return!0}function We(s,n){return l=>{if(s[0]===s[1]||n[0]===n[1])return n[0];const i=(n[1]-n[0])/(s[1]-s[0]);return n[0]+i*(l-s[0])}}function Ts(s){return(String(s).split(".")[1]||"").length}function _s(s,n){const l=Math.pow(10,n);return Math.round(s*l)/l}var $s=St,Is=Et,zs=Mt,Os=Bt;function Ls({className:s,defaultValue:n,value:l,min:i=0,max:c=100,...d}){const x=o.useMemo(()=>Array.isArray(l)?l:Array.isArray(n)?n:[i,c],[l,n,i,c]);return e.jsxs($s,{"data-slot":"slider",defaultValue:n,value:l,min:i,max:c,className:me("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",s),...d,children:[e.jsx(Is,{"data-slot":"slider-track",className:me("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-4 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:e.jsx(zs,{"data-slot":"slider-range",className:me("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:x.length},(p,f)=>e.jsx(Os,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},f))]})}const ze=[{value:"equal",label:"Equal",icon:xt,color:"blue",desc:"Split equally among everyone",example:"৳300 ÷ 3 = ৳100 each"},{value:"who-joined",label:"Select People",icon:pe,color:"purple",desc:"Only those who participated",example:"Choose who was there"},{value:"itemized",label:"By Items",icon:ie,color:"emerald",desc:"Assign specific items",example:"Pizza → Ali, Burger → Sara"},{value:"custom-percentage",label:"Percentage",icon:mt,color:"orange",desc:"Custom % for each person",example:"Ali 60%, Sara 40%"},{value:"by-duration",label:"By Duration",icon:qe,color:"pink",desc:"Based on days/hours",example:"Rent by days stayed"}];function qs({members:s,currentUserId:n,onAddExpense:l}){const[i,c]=o.useState(!1),[d,x]=o.useState(1),[p,f]=o.useState(""),[w,v]=o.useState(""),[h,g]=o.useState(n),[j,N]=o.useState("equal"),[S,D]=o.useState("other"),[y,E]=o.useState(""),[M,C]=o.useState(!1),[I,T]=o.useState(""),[R,Y]=o.useState(s.map(t=>t.id)),[z,P]=o.useState("equal"),[B,W]=o.useState(Object.fromEntries(s.map(t=>[t.id,0]))),[X,Z]=o.useState(Object.fromEntries(s.map(t=>[t.id,Math.round(100/s.length)]))),[K,H]=o.useState(Object.fromEntries(s.map(t=>[t.id,1]))),[$,O]=o.useState([{item:"",amount:0,selectedBy:[]}]),_=t=>{Y(r=>r.includes(t)?r.filter(m=>m!==t):[...r,t])},Be=(t,r)=>{const m=parseFloat(r)||0;W(A=>({...A,[t]:m}))},Fe=(t,r)=>{Z({...X,[t]:r[0]})},de=(t,r)=>{const m=parseFloat(r)||0;H({...K,[t]:m})},Re=()=>{O([...$,{item:"",amount:0,selectedBy:[]}])},Se=t=>{$.length>1&&O($.filter((r,m)=>m!==t))},Ce=(t,r,m)=>{const A=[...$];r==="amount"?A[t].amount=parseFloat(m)||0:A[t].item=m,O(A)},Te=(t,r)=>{const m=[...$],A=m[t];A.selectedBy.includes(r)?A.selectedBy=A.selectedBy.filter(k=>k!==r):A.selectedBy=[...A.selectedBy,r],O(m)},Ae=()=>{const t=parseFloat(w)||0,r={};switch(j){case"equal":const m=t/s.length;s.forEach(k=>{r[k.id]=m});break;case"who-joined":if(z==="equal"){if(R.length>0){const k=t/R.length;R.forEach(L=>{r[L]=k})}}else R.forEach(k=>{r[k]=B[k]||0});break;case"itemized":s.forEach(k=>r[k.id]=0),$.forEach(k=>{if(k.selectedBy.length>0){const L=k.amount/k.selectedBy.length;k.selectedBy.forEach(V=>{r[V]=(r[V]||0)+L})}});break;case"custom-percentage":s.forEach(k=>{const L=X[k.id]||0;r[k.id]=t*L/100});break;case"by-duration":const A=Object.values(K).reduce((k,L)=>k+L,0);A>0&&s.forEach(k=>{const L=K[k.id]||0;r[k.id]=t*L/A});break}return r},_e=()=>{if(j==="who-joined"&&R.length===0)return"Please select at least one participant";if(j==="custom-percentage"){const t=Object.values(X).reduce((r,m)=>r+m,0);if(Math.abs(t-100)>.5)return`Percentages must add up to 100% (currently ${t.toFixed(1)}%)`}return j==="itemized"&&!$.some(r=>r.item.trim()&&r.amount>0)?"Please add at least one item with a name and amount":null},$e=async t=>{t.preventDefault(),C(!0),T("");const r=_e();if(r){T(r),C(!1);return}try{const m=Ae(),A=j==="who-joined"?R:j==="itemized"?s.filter(k=>m[k.id]>0).map(k=>k.id):s.map(k=>k.id);await l({description:p,amount:parseFloat(w),paidBy:h,splitWith:A,splitType:j,splitAmounts:m,category:S,notes:y,itemSplits:j==="itemized"?$:void 0,duration:j==="by-duration"?K:void 0}),x(1),f(""),v(""),g(n),N("equal"),Y(s.map(k=>k.id)),Z(Object.fromEntries(s.map(k=>[k.id,Math.round(100/s.length)]))),H(Object.fromEntries(s.map(k=>[k.id,1]))),O([{item:"",amount:0,selectedBy:[]}]),D("other"),E(""),T(""),c(!1)}catch(m){T(m.message||"Failed to add expense")}finally{C(!1)}},re=Ae(),he=Object.values(X).reduce((t,r)=>t+r,0),ce=parseFloat(w)||0,De=s.find(t=>t.id===h),a=()=>{if(!p.trim()){T("Please enter a description");return}if(!ce||ce<=0){T("Please enter an amount greater than zero");return}T(""),x(2)},u=()=>{T(""),x(1)},b=t=>{t&&(x(1),f(""),v(""),g(n),N("equal"),Y(s.map(r=>r.id)),Z(Object.fromEntries(s.map(r=>[r.id,Math.round(100/s.length)]))),H(Object.fromEntries(s.map(r=>[r.id,1]))),O([{item:"",amount:0,selectedBy:[]}]),D("other"),E(""),T("")),c(t)};return e.jsxs(ye,{open:i,onOpenChange:b,children:[e.jsx(ve,{asChild:!0,children:e.jsxs(F,{className:"bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Add Expense"]})}),e.jsxs(Ne,{className:"sm:max-w-xl p-0 gap-0 max-h-[90vh] flex flex-col overflow-hidden",children:[e.jsx(we,{className:"sr-only",children:"Add Group Expense"}),e.jsx(ke,{className:"sr-only",children:"Record a group expense with flexible splitting options"}),e.jsxs("div",{className:"px-6 pt-5 pb-4 border-b bg-gradient-to-r from-emerald-50 to-teal-50 dark:from-emerald-950/20 dark:to-teal-950/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Add Expense"}),e.jsx(F,{variant:"ghost",size:"icon",onClick:()=>c(!1),className:"h-8 w-8 rounded-full",children:e.jsx(It,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium ${d>=1?"bg-emerald-500 text-white":"bg-gray-200 text-gray-600"}`,children:[d>1?e.jsx(lt,{className:"h-4 w-4"}):e.jsx("span",{children:"1"}),e.jsx("span",{children:"Details"})]}),e.jsx(Je,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium ${d>=2?"bg-emerald-500 text-white":"bg-gray-200 text-gray-600"}`,children:[e.jsx("span",{children:"2"}),e.jsx("span",{children:"Split"})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-5",children:[d===1&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"text-center py-4",children:[e.jsx(G,{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2 block",children:"How much was spent?"}),e.jsxs("div",{className:"relative inline-flex items-center",children:[e.jsx("span",{className:"text-3xl font-bold text-gray-400 mr-2",children:"৳"}),e.jsx(J,{type:"number",step:"0.01",min:"0.01",placeholder:"0.00",value:w,onChange:t=>v(t.target.value),className:"text-4xl font-bold text-center border-0 border-b-2 rounded-none bg-transparent w-48 h-16 focus-visible:ring-0 focus-visible:border-emerald-500",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"description",className:"text-sm font-medium",children:"What was it for?"}),e.jsx(J,{id:"description",placeholder:"e.g., Dinner, Groceries, Movie tickets...",value:p,onChange:t=>f(t.target.value),required:!0,className:"h-12 text-base"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{className:"text-sm font-medium",children:"Category"}),e.jsxs(ge,{value:S,onValueChange:D,children:[e.jsx(fe,{className:"h-12",children:e.jsx(be,{})}),e.jsx(je,{children:Zt.map(t=>{const r=t.icon;return e.jsx(q,{value:t.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{className:`h-4 w-4 ${t.color}`}),t.label]})},t.id)})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{className:"text-sm font-medium",children:"Who paid?"}),e.jsxs(ge,{value:h,onValueChange:g,children:[e.jsx(fe,{className:"h-12",children:e.jsx(be,{})}),e.jsx(je,{children:s.map(t=>e.jsx(q,{value:t.id,children:t.id===n?`${t.name} (You)`:t.name},t.id))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"notes",className:"text-sm font-medium text-gray-500",children:"Notes (optional)"}),e.jsx(Ge,{id:"notes",placeholder:"Add any details...",value:y,onChange:t=>E(t.target.value),rows:2,className:"resize-none"})]})]}),d===2&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-gradient-to-r from-emerald-500 to-teal-600 text-white",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-90",children:"Total Amount"}),e.jsxs("p",{className:"text-2xl font-bold",children:["৳",ce.toFixed(2)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm opacity-90",children:"Paid by"}),e.jsx("p",{className:"font-semibold",children:De?.name||"Unknown"})]})]}),e.jsx("p",{className:"text-sm mt-2 opacity-90",children:p})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(G,{className:"text-sm font-medium",children:"How to split?"}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:ze.map(t=>{const r=t.icon,m=j===t.value;return e.jsxs("button",{type:"button",onClick:()=>N(t.value),className:`p-2 rounded-xl border-2 text-center transition-all ${m?t.value==="equal"?"border-blue-500 bg-blue-50 dark:bg-blue-950/20":t.value==="who-joined"?"border-purple-500 bg-purple-50 dark:bg-purple-950/20":t.value==="itemized"?"border-emerald-500 bg-emerald-50 dark:bg-emerald-950/20":t.value==="custom-percentage"?"border-orange-500 bg-orange-50 dark:bg-orange-950/20":"border-pink-500 bg-pink-50 dark:bg-pink-950/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[e.jsx(r,{className:`h-5 w-5 mx-auto mb-1 ${m?t.value==="equal"?"text-blue-600 dark:text-blue-400":t.value==="who-joined"?"text-purple-600 dark:text-purple-400":t.value==="itemized"?"text-emerald-600 dark:text-emerald-400":t.value==="custom-percentage"?"text-orange-600 dark:text-orange-400":"text-pink-600 dark:text-pink-400":"text-gray-400"}`}),e.jsx("p",{className:"text-xs font-medium truncate",children:t.label})]},t.value)})}),e.jsxs("div",{className:"p-3 rounded-lg bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:ze.find(t=>t.value===j)?.desc}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 italic",children:ze.find(t=>t.value===j)?.example})]})]}),e.jsxs("div",{className:"transition-all duration-200",children:[j==="equal"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400 mb-2",children:[e.jsx("span",{children:"Each person pays:"}),e.jsxs("span",{className:"font-bold text-emerald-600 text-lg",children:["৳",(ce/(s.length||1)).toFixed(2)]})]}),s.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white dark:bg-gray-800 border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center text-emerald-600 font-semibold text-sm",children:t.name.charAt(0).toUpperCase()}),e.jsx("span",{className:"font-medium",children:t.id===n?`${t.name} (You)`:t.name})]}),e.jsxs("span",{className:"font-bold text-emerald-600",children:["৳",(re[t.id]||0).toFixed(2)]})]},t.id))]}),j==="who-joined"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2 p-1 bg-gray-100 dark:bg-gray-900 rounded-lg",children:[e.jsxs("button",{type:"button",onClick:()=>P("equal"),className:`flex-1 px-3 py-2 rounded-md text-sm font-medium transition-all ${z==="equal"?"bg-purple-500 text-white shadow-sm":"text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100"}`,children:[e.jsx(xt,{className:"h-4 w-4 inline mr-2"}),"Split Equally"]}),e.jsxs("button",{type:"button",onClick:()=>P("manual"),className:`flex-1 px-4 py-2 rounded-md text-sm font-medium transition-all ${z==="manual"?"bg-purple-500 text-white shadow-sm":"text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100"}`,children:[e.jsx(ie,{className:"h-4 w-4 inline mr-2"}),"Manual Amounts"]})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:z==="equal"?"Select members and split the cost equally among them.":"Select members and manually enter the amount each person spent."}),e.jsx("div",{className:"space-y-2",children:s.map(t=>{const r=R.includes(t.id);return e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg transition-all ${r?"bg-purple-50 dark:bg-purple-900/20 border-2 border-purple-500 dark:border-purple-600":"border-2 border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(vs,{checked:r,onCheckedChange:m=>{Y(m?A=>[...A,t.id]:A=>A.filter(k=>k!==t.id))},className:"data-[state=checked]:bg-purple-600 data-[state=checked]:border-purple-600"}),e.jsx("label",{className:"font-medium text-gray-900 dark:text-gray-100 cursor-pointer flex-1",onClick:()=>_(t.id),children:t.name})]}),r&&(z==="manual"?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"৳"}),e.jsx(J,{type:"number",placeholder:"0.00",value:B[t.id]||"",onChange:m=>Be(t.id,m.target.value),className:"w-28 h-9 text-right",step:"0.01",min:"0"})]}):e.jsxs("div",{className:"px-3 py-1.5 rounded-lg bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400 font-semibold border border-emerald-200 dark:border-emerald-800",children:["৳",(re[t.id]||0).toFixed(2)]}))]},t.id)})}),z==="manual"&&R.length>0&&e.jsxs("div",{className:"p-4 rounded-lg bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"Total Entered:"}),e.jsxs("span",{className:`text-sm font-semibold ${R.reduce((t,r)=>t+(B[r]||0),0)===parseFloat(w||"0")?"text-emerald-600 dark:text-emerald-400":"text-red-600 dark:text-red-400"}`,children:["৳",R.reduce((t,r)=>t+(B[r]||0),0).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Expected Total:"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:["৳",parseFloat(w||"0").toFixed(2)]})]}),R.reduce((t,r)=>t+(B[r]||0),0)!==parseFloat(w||"0")&&e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-2",children:"⚠️ Amounts don't match the total expense"})]})]}),j==="itemized"&&e.jsxs("div",{className:"p-5 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-emerald-100 dark:bg-emerald-900/30",children:e.jsx(ie,{className:"h-4 w-4 text-emerald-600 dark:text-emerald-400"})}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:"What did each person order?"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Add items and assign them to the people who ordered them."}),e.jsxs("div",{className:"space-y-3",children:[$.map((t,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-gray-200 dark:border-gray-700 space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(J,{placeholder:"Item name (e.g., Pizza)",value:t.item,onChange:m=>Ce(r,"item",m.target.value),className:"flex-1 h-10"}),e.jsxs("div",{className:"relative w-32",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm text-muted-foreground",children:"৳"}),e.jsx(J,{type:"number",placeholder:"0.00",value:t.amount||"",onChange:m=>Ce(r,"amount",m.target.value),className:"pl-8 h-10",step:"0.01"})]}),$.length>1&&e.jsx(F,{type:"button",variant:"ghost",size:"icon",onClick:()=>Se(r),className:"h-10 w-10 text-red-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:e.jsx(ot,{className:"h-4 w-4"})})]}),e.jsxs("div",{children:[e.jsx(G,{className:"text-xs text-muted-foreground mb-2 block",children:"Who ordered this?"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(m=>{const A=t.selectedBy.includes(m.id);return e.jsx("button",{type:"button",onClick:()=>Te(r,m.id),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-all border ${A?"bg-emerald-500 text-white border-emerald-500 shadow-sm":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`,children:m.name},m.id)})})]})]},r)),e.jsxs(F,{type:"button",variant:"outline",onClick:Re,className:"w-full border-dashed border-2 hover:bg-gray-50 dark:hover:bg-gray-800",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Add Another Item"]})]}),e.jsxs("div",{className:"mt-4 p-4 rounded-lg bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3",children:"Split Summary:"}),e.jsx("div",{className:"space-y-2",children:s.map(t=>{const r=re[t.id]||0;return r===0?null:e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:t.name}),e.jsxs("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:["৳",r.toFixed(2)]})]},t.id)})})]})]}),j==="custom-percentage"&&e.jsxs("div",{className:"p-5 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-orange-100 dark:bg-orange-900/30",children:e.jsx(mt,{className:"h-4 w-4 text-orange-600 dark:text-orange-400"})}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Set custom percentages"})]}),e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-semibold ${Math.abs(he-100)<.5?"bg-emerald-50 text-emerald-700 dark:bg-emerald-900/20 dark:text-emerald-400 border border-emerald-200 dark:border-emerald-800":"bg-red-50 text-red-700 dark:bg-red-900/20 dark:text-red-400 border border-red-200 dark:border-red-800"}`,children:["Total: ",he.toFixed(0),"%"]})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Adjust the percentage each person should pay. Must total 100%."}),e.jsx("div",{className:"space-y-4",children:s.map(t=>{const r=X[t.id]||0,m=re[t.id]||0;return e.jsxs("div",{className:"p-4 rounded-lg border border-gray-200 dark:border-gray-700 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:t.name}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:[r,"%"]}),e.jsxs("div",{className:"px-3 py-1.5 rounded-lg bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400 font-semibold border border-emerald-200 dark:border-emerald-800",children:["৳",m.toFixed(2)]})]})]}),e.jsx(Ls,{value:[r],onValueChange:A=>Fe(t.id,A),max:100,step:1,className:"w-full"})]},t.id)})})]}),j==="by-duration"&&e.jsxs("div",{className:"p-5 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-pink-100 dark:bg-pink-900/30",children:e.jsx(qe,{className:"h-4 w-4 text-pink-600 dark:text-pink-400"})}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Days/hours each person spent"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Enter how many days or hours each person participated, and the cost will be split proportionally."}),e.jsx("div",{className:"space-y-2",children:s.map(t=>{const r=K[t.id]||0,m=re[t.id]||0;return e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 transition-colors",children:[e.jsx("div",{className:"h-9 w-9 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center",children:e.jsx(qe,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})}),e.jsx("span",{className:"font-medium flex-1 text-gray-900 dark:text-gray-100",children:t.name}),e.jsx(J,{type:"number",value:r||"",onChange:A=>de(t.id,A.target.value),className:"w-24 h-9 text-center",step:"0.5",min:"0",placeholder:"0"}),e.jsx("span",{className:"text-sm text-muted-foreground w-12",children:"days"}),e.jsxs("div",{className:"px-3 py-1.5 rounded-lg bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400 font-semibold min-w-[80px] text-center border border-emerald-200 dark:border-emerald-800",children:["৳",m.toFixed(2)]})]},t.id)})})]})]})]}),I&&e.jsxs("div",{className:"mt-4 p-3 rounded-lg bg-red-50 border border-red-200 text-red-700 text-sm flex items-start gap-2",children:[e.jsx(ss,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),I]})]}),e.jsxs("div",{className:"px-6 py-4 border-t bg-gray-50 dark:bg-gray-900/50 flex gap-3",children:[d===2&&e.jsx(F,{variant:"outline",onClick:u,className:"flex-1",children:"Back"}),d===1?e.jsxs(F,{onClick:a,className:"flex-1 h-11 bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 text-white font-semibold",children:["Next: Choose Split",e.jsx(Je,{className:"h-4 w-4 ml-2"})]}):e.jsx(F,{onClick:$e,className:"flex-1 h-11 bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 text-white font-semibold",disabled:M,children:M?"Adding...":"Add Expense"})]})]})]})}const Vs=zt("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function et({className:s,variant:n,...l}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:me(Vs({variant:n}),s),...l})}function tt({className:s,...n}){return e.jsx("div",{"data-slot":"alert-description",className:me("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",s),...n})}function Ks({expenses:s,members:n,currentUserId:l,groupName:i,onSettle:c}){const[d,x]=o.useState(!1),[p,f]=o.useState(!1),w=s.reduce((N,S)=>N+S.amount,0),v=s.filter(N=>N.paidBy===l),h=v.reduce((N,S)=>N+S.amount,0),g=n.map(N=>{const S=s.filter(y=>y.paidBy===N.id),D=S.reduce((y,E)=>y+E.amount,0);return{member:N,total:D,expenseCount:S.length}}).filter(N=>N.total>0),j=async()=>{f(!0);try{await c(),x(!1)}catch(N){console.error("Failed to settle bill:",N)}finally{f(!1)}};return e.jsxs(ye,{open:d,onOpenChange:x,children:[e.jsx(ve,{asChild:!0,children:e.jsxs(F,{variant:"outline",className:"bg-gradient-to-r from-blue-500 to-indigo-600 text-white hover:from-blue-600 hover:to-indigo-700 border-0",children:[e.jsx(ct,{className:"h-4 w-4 mr-2"}),"Settle & Sync to Tracker"]})}),e.jsxs(Ne,{className:"sm:max-w-lg",children:[e.jsxs(Pe,{children:[e.jsx(we,{children:"Settle Group Bill"}),e.jsx(ke,{children:"Review the bill breakdown and sync expenses to your personal tracker"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(et,{className:"border-emerald-200 bg-emerald-50 dark:bg-emerald-900/20",children:[e.jsx(as,{className:"h-4 w-4 text-emerald-600"}),e.jsxs(tt,{className:"text-emerald-900 dark:text-emerald-100",children:[e.jsx("strong",{children:"Total Group Bill:"})," ৳",w.toFixed(2)]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground",children:"Individual Contributions:"}),g.map(({member:N,total:S,expenseCount:D})=>e.jsx("div",{className:`p-3 rounded-lg border ${N.id===l?"bg-emerald-50 border-emerald-200":"bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[N.name,N.id===l&&" (You)"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[D," expense",D!==1?"s":""]})]}),e.jsxs("p",{className:"font-semibold text-emerald-600 dark:text-emerald-400",children:["৳",S.toFixed(2)]})]})},N.id))]}),e.jsxs(et,{className:"border-blue-200 bg-blue-50 dark:bg-blue-900/20",children:[e.jsx(ms,{className:"h-4 w-4 text-blue-600"}),e.jsxs(tt,{className:"text-blue-900 dark:text-blue-100 text-sm",children:["When you settle, your ",v.length," expense",v.length!==1?"s":""," (৳",h.toFixed(2),") will be added to your personal expense tracker for analysis and budgeting."]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(F,{variant:"outline",className:"flex-1",onClick:()=>x(!1),children:"Cancel"}),e.jsx(F,{className:"flex-1 bg-gradient-to-r from-emerald-500 to-teal-600 text-white hover:from-emerald-600 hover:to-teal-700",onClick:j,disabled:p||s.length===0,children:p?"Settling...":"Settle & Sync"})]})]})]})]})}function st({members:s,currentUserId:n,defaultFromId:l,defaultToId:i,defaultAmount:c,onRecordPayment:d,triggerVariant:x="button"}){const[p,f]=o.useState(!1),[w,v]=o.useState(l||n),[h,g]=o.useState(i||""),[j,N]=o.useState(c?.toString()||""),[S,D]=o.useState(""),[y,E]=o.useState(!1),[M,C]=o.useState(""),I=P=>P.id===n?`${P.name||P.username} (You)`:P.name||P.username||"Unknown",T=()=>{v(l||n),g(i||""),N(c?.toString()||""),D(""),C("")},R=P=>{f(P),P&&T()},Y=async()=>{if(C(""),!w||!h){C("Please select both payer and recipient");return}if(w===h){C("Payer and recipient must be different people");return}const P=parseFloat(j);if(!P||P<=0){C("Please enter a valid amount greater than zero");return}E(!0);try{await d({fromMemberId:w,toMemberId:h,amount:P,note:S.trim()||void 0}),f(!1),T()}catch(B){console.error("Failed to record payment:",B),C("Failed to record payment. Please try again.")}finally{E(!1)}},z=s.filter(P=>P.id!==w);return e.jsxs(ye,{open:p,onOpenChange:R,children:[e.jsx(ve,{asChild:!0,children:x==="icon"?e.jsxs(F,{variant:"outline",size:"sm",className:"h-7 px-2 text-xs border-emerald-300 text-emerald-700 hover:bg-emerald-50",children:[e.jsx(es,{className:"h-3 w-3 mr-1"}),"Settle"]}):e.jsxs(F,{variant:"outline",className:"border-emerald-300 text-emerald-700 hover:bg-emerald-50",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Record Payment"]})}),e.jsxs(Ne,{className:"sm:max-w-[425px]",children:[e.jsxs(Pe,{children:[e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-5 w-5 text-emerald-600"}),"Record a Payment"]}),e.jsx(ke,{children:"Track when someone pays back what they owe. This will update the group balances."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[M&&e.jsx("div",{className:"p-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-lg",children:M}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"from-member",children:"Who paid?"}),e.jsxs(ge,{value:w,onValueChange:v,children:[e.jsx(fe,{id:"from-member",children:e.jsx(be,{placeholder:"Select payer"})}),e.jsx(je,{children:s.map(P=>e.jsx(q,{value:P.id,children:I(P)},P.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"to-member",children:"Paid to whom?"}),e.jsxs(ge,{value:h,onValueChange:g,children:[e.jsx(fe,{id:"to-member",children:e.jsx(be,{placeholder:"Select recipient"})}),e.jsx(je,{children:z.map(P=>e.jsx(q,{value:P.id,children:I(P)},P.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"amount",children:"Amount (৳)"}),e.jsx(J,{id:"amount",type:"number",placeholder:"0.00",min:"0.01",step:"0.01",value:j,onChange:P=>N(P.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"note",children:"Note (optional)"}),e.jsx(Ge,{id:"note",placeholder:"e.g., Paid via bKash",value:S,onChange:P=>D(P.target.value),rows:2})]})]}),e.jsxs(Vt,{children:[e.jsx(F,{variant:"outline",onClick:()=>f(!1),disabled:y,children:"Cancel"}),e.jsx(F,{onClick:Y,disabled:y||!w||!h||!j,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:y?"Recording...":"Record Payment"})]})]})]})}function Hs({group:s,currentUserId:n,friends:l,onBack:i,onAddMember:c,onAddExpense:d,onRecordPayment:x,onSimplify:p,onSettleAndSync:f,onDeleteGroup:w}){const[v,h]=o.useState(!1),[g,j]=o.useState(""),[N,S]=o.useState("all"),[D,y]=o.useState(!1),E=s.createdBy===n,M="__",C=a=>{if(a.includes(M)){const[b,t]=a.split(M);return{creditorId:b,debtorId:t}}const u=a.split("-");return u.length>=10?{creditorId:u.slice(0,5).join("-"),debtorId:u.slice(5).join("-")}:u.length>=2?{creditorId:u[0],debtorId:u.slice(1).join("-")}:{creditorId:a,debtorId:a}},I=s.summary?.memberSummaries||[],T=o.useMemo(()=>{const a=s.balances||{},u=new Set(s.members.map(A=>A.id));let b=0,t=0;const r=[],m=[];return Object.entries(a).forEach(([A,k])=>{if(typeof k!="number"||Math.abs(k)<.01)return;const{creditorId:L,debtorId:V}=C(A);!u.has(L)||!u.has(V)||(V===n?(b+=k,r.push({memberId:L,amount:k})):L===n&&(t+=k,m.push({memberId:V,amount:k})))}),{youOwe:parseFloat(b.toFixed(2)),youAreOwed:parseFloat(t.toFixed(2)),netBalance:parseFloat((t-b).toFixed(2)),whoYouOwe:r,whoOwesYou:m}},[s.balances,s.members,n]),{youOwe:R,youAreOwed:Y,netBalance:z,whoYouOwe:P,whoOwesYou:B}=T;s.summary?s.summary.outstandingBalance:Object.values(s.balances||{}).reduce((a,u)=>a+(typeof u=="number"?u:0),0);const W=z>0?"text-emerald-600":z<0?"text-red-600":"text-muted-foreground",X=z>0?"You are owed money overall":z<0?"You still owe money overall":"All settled up!",Z=o.useMemo(()=>{const a={},u=(b,t)=>{b&&(a[b]={name:t.name||a[b]?.name,username:t.username||a[b]?.username,email:t.email||a[b]?.email})};return s.members.forEach(b=>{u(b.id,{name:b.name,username:b.username,email:b.email})}),l.forEach(b=>{u(b.id,{name:b.name,username:b.username,email:b.email})}),a},[s.members,l]),K=a=>a?a.startsWith("@")?a:`@${a}`:"",H=a=>{if(!a)return"";const[u]=a.split("@");return u||""},$=async()=>{h(!0);try{await p()}catch(a){console.error("Failed to simplify debts:",a)}finally{h(!1)}},O=async()=>{y(!0);try{await w()}catch(a){console.error("Failed to delete group:",a)}finally{y(!1)}},_=a=>{if(a===n)return"You";const u=Z[a],b=u?.name?.trim()||K(u?.username)||H(u?.email);return b||`Member ${a?`${a.substring(0,6)}…`:"member"}`},Be=a=>(a.name?.trim()||K(a.username)||H(a.email)||"?").charAt(0).toUpperCase(),Fe=a=>a.name?.trim()||K(a.username)||H(a.email)||"Member",de=a=>a.splitAmounts&&Object.keys(a.splitAmounts).length>0?Array.from(new Set(Object.keys(a.splitAmounts))):Array.from(new Set(a.splitWith||[])),Re=a=>{switch(a.splitType){case"itemized":return"Item totals";case"custom-percentage":case"percentage":return"Percentage split";case"by-duration":return"Duration-based split";case"who-joined":return"Participants";case"unequal":return"Custom split";default:return"Split details"}},Se=(a,u)=>a.splitAmounts?(a.splitType==="custom-percentage"||a.splitType==="percentage")&&a.amount>0?` (${((a.splitAmounts[u]||0)/a.amount*100).toFixed(1)}%)`:a.splitType==="by-duration"&&a.duration?.[u]?` (${a.duration[u]} days)`:"":"",Ce=a=>{if((!a.splitType||a.splitType==="equal"||!a.splitAmounts)&&!(a.splitType==="itemized"&&a.itemSplits?.length))return null;const u=de(a).filter(r=>{const m=a.splitAmounts?.[r]||0;return Math.abs(m)>.009}),b=u.length>0&&a.splitAmounts,t=a.splitType==="itemized"&&a.itemSplits&&a.itemSplits.length>0;return!b&&!t?null:e.jsxs("div",{className:"mt-2 space-y-2",children:[b&&e.jsxs("div",{className:"text-xs text-muted-foreground bg-gray-50 p-2 rounded",children:[e.jsx("p",{className:"font-medium mb-1",children:Re(a)}),e.jsx("div",{className:"space-y-0.5",children:u.map(r=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[_(r),Se(a,r)]}),e.jsxs("span",{children:["৳",(a.splitAmounts[r]||0).toFixed(2)]})]},r))})]}),t&&e.jsxs("div",{className:"text-xs bg-emerald-50/80 text-emerald-900 p-2 rounded border border-emerald-100",children:[e.jsx("p",{className:"font-medium mb-1",children:"Itemized breakdown"}),e.jsx("div",{className:"space-y-1",children:a.itemSplits.map((r,m)=>e.jsxs("div",{className:"border border-emerald-100 rounded px-2 py-1 bg-white/60",children:[e.jsxs("div",{className:"flex justify-between text-[13px] text-gray-900",children:[e.jsx("span",{className:"font-semibold",children:r.item||"Item"}),e.jsxs("span",{className:"font-semibold",children:["৳",(r.amount||0).toFixed(2)]})]}),e.jsx("p",{className:"text-[11px] text-muted-foreground mt-0.5",children:(r.selectedBy||[]).length>0?r.selectedBy.map(_).join(", "):"No attendees selected"})]},`${r.item}-${m}`))})]})]})},Te=(a,u,b)=>a.filter(t=>{const r=u===""||t.description.toLowerCase().includes(u.toLowerCase())||_(t.paidBy).toLowerCase().includes(u.toLowerCase())||t.notes?.toLowerCase().includes(u.toLowerCase()),m=b==="all"||t.category===b;return r&&m}),Ae=a=>{if(!a.splitAmounts)return"";let t=de(a).map(r=>{const m=a.splitAmounts[r]||0;if(Math.abs(m)<=.009)return null;const A=Se(a,r);return`${_(r)}: ৳${m.toFixed(2)}${A}`}).filter(Boolean).join(" | ");if(a.splitType==="itemized"&&a.itemSplits?.length){const r=a.itemSplits.map(m=>{const A=(m.selectedBy||[]).map(_).join(", ")||"Unassigned";return`${m.item||"Item"} ৳${(m.amount||0).toFixed(2)} → ${A}`}).join(" | ");t=t?`${t} || Items: ${r}`:`Items: ${r}`}if(a.splitType==="by-duration"&&a.duration){const r=Object.entries(a.duration).map(([m,A])=>`${_(m)}: ${A} days`).join(" | ");t=t?`${t} || Duration: ${r}`:`Duration: ${r}`}return t},_e=a=>{const u=["Date","Description","Category","Amount","Paid By","Split Type","Participants","Split Details","Notes"],b=a.map(t=>{const r=de(t);return[new Date(t.createdAt).toLocaleDateString(),t.description,Qe(t.category||"other").label,t.amount.toFixed(2),_(t.paidBy),he(t.splitType),r.map(m=>_(m)).join("; "),Ae(t),t.notes||""]});return[u,...b].map(t=>t.map(r=>`"${r}"`).join(",")).join(`
`)},$e=(a,u)=>{const b=new Blob([a],{type:"text/csv"}),t=window.URL.createObjectURL(b),r=document.createElement("a");r.href=t,r.download=u,r.click(),window.URL.revokeObjectURL(t)},re={equal:"Equal split",unequal:"Custom split",percentage:"Percentage split","who-joined":"Who Joined",itemized:"Itemized split","custom-percentage":"Custom % split","by-duration":"Duration-based split"},he=a=>a?re[a]||"Custom split":"Equal split",ce=()=>{const a=s.balances||{},u=new Set(s.members.map(t=>t.id)),b=Object.entries(a).filter(([t,r])=>{if(Math.abs(r)<=.01)return!1;const{creditorId:m,debtorId:A}=C(t);return u.has(m)&&u.has(A)});return b.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"inline-flex p-3 rounded-full bg-emerald-100 mb-2",children:e.jsx(ct,{className:"h-6 w-6 text-emerald-600"})}),e.jsx("p",{className:"text-muted-foreground",children:"All settled up! 🎉"})]}):e.jsx("div",{className:"space-y-2",children:b.map(([t,r])=>{const{creditorId:m,debtorId:A}=C(t),k=_(m),L=_(A),V=A===n,ue=m===n;return e.jsxs("div",{className:`flex justify-between items-center p-3 rounded-lg border transition-colors ${V?"bg-red-50 border-red-200":ue?"bg-emerald-50 border-emerald-200":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-medium ${V?"text-red-700":ue?"text-emerald-700":"text-gray-700"}`,children:L}),e.jsx(Lt,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:`text-sm font-medium ${ue?"text-emerald-700":V?"text-red-700":"text-gray-700"}`,children:k})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`font-bold ${V?"text-red-600":ue?"text-emerald-600":"text-gray-700"}`,children:["৳",r.toFixed(2)]}),(V||ue)&&e.jsx(st,{members:s.members,currentUserId:n,defaultFromId:V?n:A,defaultToId:V?m:n,defaultAmount:r,onRecordPayment:x,triggerVariant:"icon"})]})]},t)})})},De=s.expenses.reduce((a,u)=>a+u.amount,0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(F,{variant:"ghost",size:"icon",onClick:i,className:"hover:bg-emerald-100 dark:hover:bg-emerald-900/30",children:e.jsx(Ot,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("h2",{children:s.name}),E&&e.jsxs(Ie,{className:"bg-gradient-to-r from-amber-500 to-orange-600 text-white border-0",children:[e.jsx(Ze,{className:"h-3 w-3 mr-1"}),"Leader"]})]}),s.description&&e.jsx("p",{className:"text-muted-foreground text-sm",children:s.description}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Created by ",_(s.createdBy)]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(st,{members:s.members,currentUserId:n,onRecordPayment:x}),e.jsx(Ks,{expenses:s.expenses,members:s.members,currentUserId:n,groupName:s.name,onSettle:f}),E&&e.jsxs(Kt,{children:[e.jsx(Ht,{asChild:!0,children:e.jsxs(F,{variant:"outline",size:"sm",className:"border-red-300 text-red-600 hover:bg-red-50 dark:border-red-700 dark:text-red-400 dark:hover:bg-red-900/20",children:[e.jsx(ot,{className:"h-4 w-4 mr-2"}),"Delete Group"]})}),e.jsxs(Gt,{children:[e.jsxs(Yt,{children:[e.jsxs(Wt,{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-5 w-5 text-red-600"}),"Delete Group?"]}),e.jsxs(Xt,{children:['This will permanently delete the group "',s.name,'" and all its expenses. This action cannot be undone. All members will lose access to this group.']})]}),e.jsxs(Jt,{children:[e.jsx(Qt,{children:"Cancel"}),e.jsx(Ut,{onClick:O,disabled:D,className:"bg-red-600 hover:bg-red-700 text-white",children:D?"Deleting...":"Delete Group"})]})]})]})]})]}),e.jsxs("section",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(Q,{className:"border shadow-sm",children:[e.jsx(ne,{className:"pb-2",children:e.jsx(le,{className:"text-xs font-semibold uppercase text-muted-foreground tracking-wide",children:"You owe"})}),e.jsxs(U,{children:[e.jsxs("p",{className:`text-3xl font-semibold ${R>0?"text-red-600":"text-muted-foreground"}`,children:["৳",R.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Amount you need to settle across the group."})]})]}),e.jsxs(Q,{className:"border shadow-sm",children:[e.jsx(ne,{className:"pb-2",children:e.jsx(le,{className:"text-xs font-semibold uppercase text-muted-foreground tracking-wide",children:"You are owed"})}),e.jsxs(U,{children:[e.jsxs("p",{className:`text-3xl font-semibold ${Y>0?"text-emerald-600":"text-muted-foreground"}`,children:["৳",Y.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Total others should pay you back."})]})]}),e.jsxs(Q,{className:"border shadow-sm",children:[e.jsx(ne,{className:"pb-2",children:e.jsx(le,{className:"text-xs font-semibold uppercase text-muted-foreground tracking-wide",children:"Net balance"})}),e.jsxs(U,{children:[e.jsxs("p",{className:`text-3xl font-semibold ${W}`,children:["৳",z.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:X})]})]})]}),De>0&&e.jsx(Q,{className:"border-2 border-emerald-200 bg-white",children:e.jsx(U,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Total Group Bill"}),e.jsxs("p",{className:"text-3xl font-bold text-emerald-600 dark:text-emerald-400",children:["৳",De.toFixed(2)]})]}),e.jsx("div",{className:"p-4 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600",children:e.jsx(ie,{className:"h-8 w-8 text-white"})})]})})}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(Q,{className:"border-0 shadow-xl bg-white",children:[e.jsxs(ne,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[e.jsx(le,{className:"text-lg",children:"Members"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gs,{friends:l,existingMemberIds:s.members.map(a=>a.id),onAddMember:c}),e.jsx(pe,{className:"h-5 w-5 text-muted-foreground"})]})]}),e.jsx(U,{children:e.jsx("div",{className:"space-y-2",children:s.members.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition-colors border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center text-white font-semibold",children:Be(a)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:Fe(a)}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",a.username]}),(()=>{const u=I.find(m=>m.memberId===a.id);if(!u)return null;const b=u.netBalance,t=b>0?`Owed ৳${b.toFixed(2)}`:b<0?`Owes ৳${Math.abs(b).toFixed(2)}`:"Settled up",r=b>0?"text-emerald-600":b<0?"text-red-600":"text-muted-foreground";return e.jsx("p",{className:`text-xs font-medium ${r}`,children:t})})()]})]}),a.id===s.createdBy&&e.jsxs(Ie,{variant:"outline",className:"border-amber-500 text-amber-600 dark:text-amber-400",children:[e.jsx(Ze,{className:"h-3 w-3 mr-1"}),"Leader"]})]},a.id))})})]}),e.jsxs(Q,{className:"border-0 shadow-xl bg-white",children:[e.jsxs(ne,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[e.jsx(le,{className:"text-lg",children:"Balances"}),e.jsx(Ue,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsxs(U,{children:[ce(),Object.keys(s.balances||{}).length>0&&e.jsxs(F,{className:"w-full mt-4 bg-gradient-to-r from-blue-500 to-indigo-600 text-white hover:from-blue-600 hover:to-indigo-700",variant:"outline",onClick:$,disabled:v,children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),v?"Simplifying...":"Simplify Debts"]})]})]})]}),e.jsxs(Q,{className:"border-0 shadow-xl bg-white",children:[e.jsxs(ne,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[e.jsx(le,{className:"text-lg",children:"Expenses"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(F,{variant:"ghost",size:"sm",onClick:()=>{const a=_e(s.expenses);$e(a,`${s.name}-expenses.csv`)},children:[e.jsx(ts,{className:"h-4 w-4 mr-1"}),"Export"]}),e.jsx(qs,{members:s.members,currentUserId:n,onAddExpense:d}),e.jsx(ie,{className:"h-5 w-5 text-muted-foreground"})]})]}),e.jsxs(U,{children:[s.expenses.length>0&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(J,{placeholder:"Search expenses...",value:g,onChange:a=>j(a.target.value),className:"w-full"})}),e.jsxs(ge,{value:N,onValueChange:S,children:[e.jsx(fe,{className:"w-[180px]",children:e.jsx(be,{placeholder:"All Categories"})}),e.jsxs(je,{children:[e.jsx(q,{value:"all",children:"All Categories"}),e.jsx(q,{value:"food",children:"Food & Dining"}),e.jsx(q,{value:"groceries",children:"Groceries"}),e.jsx(q,{value:"transport",children:"Transport"}),e.jsx(q,{value:"entertainment",children:"Entertainment"}),e.jsx(q,{value:"utilities",children:"Utilities"}),e.jsx(q,{value:"housing",children:"Housing"}),e.jsx(q,{value:"travel",children:"Travel"}),e.jsx(q,{value:"gifts",children:"Gifts"}),e.jsx(q,{value:"healthcare",children:"Healthcare"}),e.jsx(q,{value:"other",children:"Other"})]})]})]}),s.expenses.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No expenses yet"}):e.jsx("div",{className:"space-y-3",children:Te(s.expenses,g,N).map(a=>{const u=Qe(a.category||"other"),b=u.icon,t=a.paidBy===n,r=de(a);return e.jsxs("div",{className:`p-4 border rounded-lg hover:shadow-sm transition-shadow ${t?"border-emerald-200 bg-emerald-50/50 dark:bg-emerald-900/10 dark:border-emerald-800":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:`p-1 rounded ${u.bgColor}`,children:e.jsx(b,{className:`h-4 w-4 ${u.color}`})}),e.jsx("p",{className:"font-medium",children:a.description}),t&&e.jsx(Ie,{className:"bg-emerald-500 text-white text-xs",children:"You paid"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Paid by ",_(a.paidBy)]}),a.notes&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1 italic",children:a.notes}),Ce(a)]}),e.jsxs("p",{className:"text-emerald-600 dark:text-emerald-400 font-semibold text-lg",children:["৳",a.amount.toFixed(2)]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${u.bgColor} ${u.color}`,children:u.label}),e.jsx("span",{className:"mx-2",children:"•"}),he(a.splitType),e.jsx("span",{className:"mx-2",children:"•"}),r.length||a.splitWith.length," people",e.jsx("span",{className:"mx-2",children:"•"}),new Date(a.createdAt).toLocaleDateString()]})]},a.id)})})]})]}),s.activity&&s.activity.length>0&&e.jsxs(Q,{className:"border-0 shadow-xl bg-white",children:[e.jsxs(ne,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[e.jsx(le,{className:"text-lg",children:"Recent Activity"}),e.jsx(ns,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsx(U,{children:e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:s.activity.slice(0,10).map(a=>{const u=a.type==="expense",b=a.type==="payment";return e.jsx("div",{className:`p-3 rounded-lg border ${u?"bg-blue-50 border-blue-100":"bg-emerald-50 border-emerald-100"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-full ${u?"bg-blue-100":"bg-emerald-100"}`,children:u?e.jsx(ie,{className:`h-4 w-4 ${u?"text-blue-600":"text-emerald-600"}`}):e.jsx(Le,{className:"h-4 w-4 text-emerald-600"})}),e.jsxs("div",{children:[u&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium text-sm",children:a.description||"Expense"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Paid by ",_(a.paidBy||"")]})]}),b&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium text-sm",children:"Payment recorded"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[_(a.fromMemberId||"")," paid ",_(a.toMemberId||"")]}),a.note&&e.jsx("p",{className:"text-xs text-muted-foreground italic mt-1",children:a.note})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`font-semibold ${u?"text-blue-600":"text-emerald-600"}`,children:["৳",a.amount.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(a.createdAt).toLocaleDateString()})]})]})},a.id)})})})]})]})}function Gs({onCreateGroup:s}){const[n,l]=o.useState(!1),[i,c]=o.useState(""),[d,x]=o.useState(""),[p,f]=o.useState(!1),w=async v=>{v.preventDefault(),f(!0);try{await s({name:i,description:d}),c(""),x(""),l(!1)}catch(h){console.error("Failed to create group:",h)}finally{f(!1)}};return e.jsxs(ye,{open:n,onOpenChange:l,children:[e.jsx(ve,{asChild:!0,children:e.jsxs(F,{className:"bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Create Group"]})}),e.jsxs(Ne,{className:"sm:max-w-md",children:[e.jsxs(Pe,{children:[e.jsx(we,{children:"Create New Group"}),e.jsx(ke,{children:"Create a group to split expenses with friends, roommates, or travel companions. You can add members after creating the group."})]}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"groupName",children:"Group Name"}),e.jsx(J,{id:"groupName",placeholder:"e.g., Weekend Trip, Roommates, Vacation 2024",value:i,onChange:v=>c(v.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{htmlFor:"description",children:"Description (optional)"}),e.jsx(Ge,{id:"description",placeholder:"What's this group for?",value:d,onChange:v=>x(v.target.value),rows:3})]}),e.jsx(F,{type:"submit",className:"w-full bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700",disabled:p,children:p?"Creating...":"Create Group"})]})]})]})}function ra({groups:s,selectedGroupId:n,selectedGroup:l,currentUserId:i,loading:c,friends:d,onSelectGroup:x,onCreateGroup:p,onBackToGroups:f,onAddMember:w,onAddExpense:v,onRecordPayment:h,onSimplify:g,onSettleAndSync:j,onDeleteGroup:N,onAddFriend:S,onAddFriendByEmail:D,onAddFriendByCode:y,onSearchSuggestions:E}){const M=[{label:"Active crews",value:s.length},{label:"Friends invited",value:d?.length??0},{label:"Awaiting settlements",value:s.filter(C=>C.outstandingBalance>0).length}];return n&&l?e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 pb-16",children:[e.jsx("section",{className:"rounded-[32px] bg-gradient-to-br from-gray-900 via-emerald-950 to-gray-900 p-8 text-white",children:e.jsxs("div",{className:"flex flex-col gap-6 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-white/60",children:"Group detail"}),e.jsx("h1",{className:"mt-2 text-4xl font-semibold",children:l.name}),e.jsx("p",{className:"mt-2 text-white/70",children:l.description||"Shared expenses, consolidated."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{onClick:f,className:"rounded-full border border-white/30 px-5 py-2 text-sm text-white hover:bg-white/10",children:"Back to crews"}),e.jsx("button",{onClick:g,className:"rounded-full bg-white px-6 py-2 text-sm font-medium text-gray-900 hover:bg-white/90",children:"Simplify balances"})]})]})}),e.jsx(Hs,{group:l,currentUserId:i,friends:d||[],onBack:f,onAddMember:w,onAddExpense:v,onRecordPayment:h,onSimplify:g,onSettleAndSync:j,onDeleteGroup:N})]}):n&&c?e.jsx("div",{className:"max-w-7xl mx-auto space-y-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex p-8 rounded-full bg-emerald-100 mb-4 animate-pulse",children:e.jsxs("svg",{className:"h-12 w-12 text-emerald-600 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),e.jsx("p",{className:"text-gray-600",children:"Loading group details..."})]})}):e.jsxs("div",{className:"max-w-7xl mx-auto space-y-10 pb-16",children:[e.jsxs("section",{className:"rounded-[36px] bg-gradient-to-br from-teal-900 via-emerald-900 to-gray-900 p-10 text-white",children:[e.jsxs("div",{className:"flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-white/60",children:"Crews & rituals"}),e.jsx("h1",{className:"mt-3 text-4xl font-semibold",children:"Group operations lounge"}),e.jsx("p",{className:"mt-4 max-w-2xl text-white/70",children:"Spin up travel pods, rent squads, or project crews and keep every split, settlement, and recap synced."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[S&&D&&y&&E&&e.jsx(ls,{onAddFriend:S,onAddFriendByEmail:D,onAddFriendByCode:y,onSearchSuggestions:E,userFriendCode:i,variant:"outline"}),e.jsx("div",{className:"rounded-full bg-white/10 px-4 py-2",children:e.jsx(Gs,{onCreateGroup:p})})]})]}),e.jsx("div",{className:"mt-8 grid gap-4 sm:grid-cols-3",children:M.map(C=>e.jsxs("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-4 text-center",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-white/60",children:C.label}),e.jsx("p",{className:"mt-3 text-3xl font-semibold",children:C.value})]},C.label))})]}),e.jsxs("section",{className:"grid gap-6 lg:grid-cols-[1.1fr_0.9fr]",children:[e.jsx("div",{className:"rounded-[28px] border border-gray-200 bg-white p-4 shadow-lg",children:c?e.jsx("div",{className:"py-12 text-center text-gray-500",children:"Loading your crews..."}):s.length>0?e.jsx(ps,{groups:s,onSelectGroup:x}):e.jsx("div",{className:"py-12 text-center text-gray-500",children:"No groups yet. Spin up your first crew."})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-[28px] border border-gray-200 bg-gray-50 p-6",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Playbook"}),e.jsx("h3",{className:"mt-2 text-2xl font-semibold text-gray-900",children:"Run the setup ritual"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Invite friends, add expenses, then simplify balances in one sweep."}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 text-sm text-gray-600",children:[e.jsx("span",{className:"rounded-full bg-white px-3 py-1",children:"Invite members"}),e.jsx("span",{className:"rounded-full bg-white px-3 py-1",children:"Log first tab"}),e.jsx("span",{className:"rounded-full bg-white px-3 py-1",children:"Simplify"})]})]}),e.jsx("div",{className:"rounded-[28px] border border-dashed border-gray-300 p-6 text-sm text-gray-600",children:"Need bespoke flows? Use the group detail view to configure custom split types, observers, and sync schedules."})]})]})]})}export{ra as GroupsPage};
